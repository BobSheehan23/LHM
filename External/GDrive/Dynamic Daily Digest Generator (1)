{"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"67d9f1dd","executionInfo":{"status":"ok","timestamp":1754536385699,"user_tz":240,"elapsed":98,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"69dcea30-d4de-4efc-9e01-39486bbdf004"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")"],"execution_count":59,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"24498ca5","executionInfo":{"status":"ok","timestamp":1754536385700,"user_tz":240,"elapsed":5,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"83543a80-a6ad-4a7b-efbe-2270c05f34c6"},"source":["display(parsed_content)"],"execution_count":60,"outputs":[{"output_type":"display_data","data":{"text/plain":["{'market_notes': {'avg_fee_bps': '',\n","  'avg_fee_change': 74.9,\n","  'avg_util_percent': '',\n","  'avg_util_change': 7.11},\n"," 'headlines': [{'title': 'Oil Prices Decline Amid OPEC+ Production and Demand Concerns',\n","   'description': 'Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.',\n","   'data_insight': 'With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.'},\n","  {'title': 'Chips and Semiconductors Underdogs Struggle to Keep Pace',\n","   'description': 'With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.',\n","   'data_insight': 'In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.'},\n","  {'title': 'European Equities Rise despite fresh tariff threats',\n","   'description': 'The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.',\n","   'data_insight': 'In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.'}],\n"," 'key_takeaways': ['Key takeaways 1', 'Key takeaways 2', 'Key takeaways 3'],\n"," 'hot_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD IN',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Fee_1_WoW_': '15,567'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Fee_1_WoW_': '5,447'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin',\n","   'Price': '$4.31',\n","   'Fee_1_WoW_': '12,527'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Srvc',\n","   'Price': '$2.02',\n","   'Fee_1_WoW_': '4,660'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals &Mining',\n","   'Price': '$12.35',\n","   'Fee_1_WoW_': '2,895'}],\n"," 'squeeze_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Short_Squeeze_Score_(SSS)': '100',\n","   'SSS_WoW': '1'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Short_Squeeze_Score_(SSS)': '99',\n","   'SSS_WoW': '2'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin’l',\n","   'Price': '$4.31',\n","   'Short_Squeeze_Score_(SSS)': '98',\n","   'SSS_WoW': '3'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Services',\n","   'Price': '$2.02',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '4'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals & Mining',\n","   'Price': '$12.35',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '5'}]}"]},"metadata":{}}]},{"cell_type":"code","source":["# -*- coding: utf-8 -*-\n","\"\"\"\n","daily_digest_generator.py\n","\n","This script dynamically generates an HTML daily digest by parsing all content\n","and tables directly from a single Microsoft Word document.\n","\"\"\"\n","\n","import pandas as pd\n","import docx\n","from datetime import datetime\n","import re\n","import numpy as np\n","\n","# --- Configuration ---\n","# The script will read all content from this single Word document.\n","# Ensure it is in the same directory as the script.\n","CONTENT_DOC_PATH = 'daily_content.docx'\n","OUTPUT_HTML_PATH = f\"equilend_daily_digest_{datetime.now().strftime('%Y_%m_%d')}.html\"\n","\n","# --- 1. DOCX Content Parsing ---\n","\n","def parse_daily_content(doc_path):\n","    \"\"\"\n","    Parses a .docx file for all text and table content, including market notes,\n","    headlines, key takeaways, and data tables.\n","    \"\"\"\n","    try:\n","        document = docx.Document(doc_path)\n","    except Exception as e:\n","        print(f\"Error opening or parsing DOCX file: {doc_path}. Error: {e}\")\n","        return None\n","\n","    content = {\n","        'market_notes': {},\n","        'headlines': [],\n","        'key_takeaways': [],\n","        'hot_stocks_data': [],\n","        'squeeze_stocks_data': []\n","    }\n","\n","    # --- Parse Paragraphs for Headlines and Key Takeaways ---\n","    paras = [p.text.strip() for p in document.paragraphs if p.text.strip()]\n","\n","    # Parse Headlines\n","    try:\n","        headline_start_index = -1\n","        for i, p_text in enumerate(paras):\n","            if 'major headlines' in p_text.lower():\n","                headline_start_index = i + 1\n","                break\n","\n","        if headline_start_index != -1:\n","            i = headline_start_index\n","            while i < len(paras):\n","                # Find the start of the next headline block\n","                if 'what our data shows' in paras[i].lower() or 'key takeaways' in paras[i].lower():\n","                    i += 1\n","                    continue\n","\n","                # Find the end of the current block (the \"What our data shows\" part)\n","                end_of_block_idx = -1\n","                for j in range(i + 1, len(paras)):\n","                    if 'what our data shows' in paras[j].lower():\n","                        end_of_block_idx = j\n","                        break\n","\n","                if end_of_block_idx != -1:\n","                    title = paras[i].rstrip(':').rstrip('.')\n","                    description = \"\\n\".join(paras[i+1:end_of_block_idx])\n","                    data_insight_raw = paras[end_of_block_idx]\n","                    data_insight = re.sub(r'[\\starbullet\\s]*What our data shows:\\s?', '', data_insight_raw, flags=re.IGNORECASE).strip()\n","\n","                    content['headlines'].append({\n","                        'title': title,\n","                        'description': description,\n","                        'data_insight': data_insight\n","                    })\n","                    i = end_of_block_idx + 1\n","                else:\n","                    break  # No more headline blocks found\n","    except Exception as e:\n","        print(f\"Warning: Could not parse Headlines. Error: {e}\")\n","\n","    # Parse Key Takeaways\n","    try:\n","        takeaways_start_index = -1\n","        for i, p_text in enumerate(paras):\n","            if 'key takeaways' in p_text.lower():\n","                takeaways_start_index = i + 1\n","                break\n","\n","        if takeaways_start_index != -1:\n","            for i in range(takeaways_start_index, len(paras)):\n","                line = paras[i].lstrip('-•* ').strip()\n","                # Stop if we hit another section or an empty line that indicates the end\n","                if not line or 'hot & getting hotter' in line.lower() or 'market technicals' in line.lower():\n","                    break\n","                content['key_takeaways'].append(line)\n","    except Exception as e:\n","        print(f\"Warning: Could not parse Key Takeaways. Error: {e}\")\n","\n","\n","    # --- Parse Tables for Market Notes and Stock Data ---\n","    print(\"\\n--- Parsing Tables ---\")\n","    for i, table in enumerate(document.tables):\n","        print(f\"Processing Table {i+1}\")\n","        if not table.rows:\n","            print(f\"Table {i+1} has no rows.\")\n","            continue\n","\n","        # Get header to identify the table\n","        header_cells = [cell.text.strip().lower() for cell in table.rows[0].cells]\n","        print(f\"Table {i+1} Header Cells: {header_cells}\")\n","\n","        # Identify and parse \"Hot & Getting Hotter\" table (Table 3, 5 columns)\n","        # Check for the header cell text 'fee 1 wow (bps)' and number of columns\n","        if 'fee 1 wow (bps)' in header_cells and len(table.rows[0].cells) == 5:\n","            print(f\"Identified 'Hot & Getting Hotter' table {i+1}\")\n","            keys = [cell.text.strip().replace(' ', '_').replace('(bps)', '').strip() for cell in table.rows[0].cells]\n","            for row in table.rows[1:]:\n","                row_data = {}\n","                for j, cell in enumerate(row.cells):\n","                    if j < len(keys): # Ensure index is within bounds of keys\n","                        row_data[keys[j]] = cell.text.strip()\n","                content['hot_stocks_data'].append(row_data)\n","            print(f\"Parsed {len(content['hot_stocks_data'])} rows for Hot & Getting Hotter.\")\n","\n","\n","        # Identify and parse \"Squeeze Metrics\" table (Table 4, 6 columns)\n","        # Check for the header cell text 'short squeeze score (sss)' and number of columns\n","        elif 'short squeeze score (sss)' in header_cells and len(table.rows[0].cells) == 6:\n","            print(f\"Identified 'Squeeze Metrics' table {i+1}\")\n","            keys = [cell.text.strip().replace(' ', '_').replace('(sss)', '').strip() for cell in table.rows[0].cells]\n","            for row in table.rows[1:]:\n","                row_data = {}\n","                for j, cell in enumerate(row.cells):\n","                     if j < len(keys): # Ensure index is within bounds of keys\n","                        row_data[keys[j]] = cell.text.strip()\n","                content['squeeze_stocks_data'].append(row_data)\n","            print(f\"Parsed {len(content['squeeze_stocks_data'])} rows for Squeeze Metrics.\")\n","\n","\n","        # Identify and parse \"Market Notes\" table (Table 2)\n","        # Based on debugging and user feedback, this table is the second table (index 1)\n","        # and now has bullet points within the cells.\n","        # Also, verify it has 2 cells in the first row.\n","        elif i == 1 and len(table.rows) > 0 and len(table.rows[0].cells) == 2:\n","            print(f\"Identified Market Notes table (Table {i+1}) based on index and cell count.\")\n","            try:\n","                # Extract text from the two cells in the first row\n","                cell1_text = table.rows[0].cells[0].text.strip()\n","                cell2_text = table.rows[0].cells[1].text.strip()\n","                print(f\"  Cell 1 text: '{cell1_text}'\")\n","                print(f\"  Cell 2 text: '{cell2_text}'\")\n","\n","                # Split the cell text by bullet points or newlines to get individual metrics\n","                cell1_metrics = re.split(r'[•\\*-]|[\\r\\n]+', cell1_text)\n","                cell2_metrics = re.split(r'[•\\*-]|[\\r\\n]+', cell2_text)\n","\n","                # Process metrics from Cell 1\n","                for metric_text in cell1_metrics:\n","                    if not metric_text.strip():\n","                        continue\n","                    # Adjusted regex to capture the value before 'bps' and after '$'\n","                    avg_fee_match = re.search(r'Average Fee:\\s*(.*?)\\s*bps\\s*([+-]?\\d+\\.?\\d*)%?', metric_text, re.IGNORECASE | re.DOTALL)\n","                    on_loan_match = re.search(r'On Loan Value:\\s*\\$(.*?)\\s*([+-]?\\d+\\.?\\d*)%', metric_text, re.IGNORECASE | re.DOTALL)\n","\n","\n","                    if avg_fee_match:\n","                        content['market_notes']['avg_fee_bps'] = avg_fee_match.group(1).strip()\n","                        try:\n","                            content['market_notes']['avg_fee_change'] = float(avg_fee_match.group(2).replace('+', ''))\n","                        except (ValueError, TypeError):\n","                            content['market_notes']['avg_fee_change'] = 0.0\n","                        print(f\"  Parsed Avg Fee: {content['market_notes'].get('avg_fee_bps')}, Change: {content['market_notes'].get('avg_fee_change')}\")\n","                    elif on_loan_match:\n","                        content['market_notes']['on_loan_value'] = on_loan_match.group(1).strip()\n","                        try:\n","                            content['market_notes']['on_loan_value_change'] = float(on_loan_match.group(2).replace('+', ''))\n","                        except (ValueError, TypeError):\n","                            content['market_notes']['on_loan_value_change'] = 0.0\n","                        print(f\"  Parsed On Loan Value: {content['market_notes'].get('on_loan_value')}, Change: {content['market_notes'].get('on_loan_value_change')}\")\n","\n","                # Process metrics from Cell 2\n","                for metric_text in cell2_metrics:\n","                    if not metric_text.strip():\n","                        continue\n","                    # Adjusted regex for Average Utilization and Total Lendable Value\n","                    avg_util_match = re.search(r'Average Utilization:\\s*(.*?)\\s*%?\\s*([+-]?\\d+\\.?\\d*)%', metric_text, re.IGNORECASE | re.DOTALL)\n","                    lendable_match = re.search(r'Total Lendable Value:\\s*\\$?(.*?)\\s*([+-]?\\d+\\.?\\d*)%', metric_text, re.IGNORECASE | re.DOTALL)\n","\n","                    if avg_util_match:\n","                        content['market_notes']['avg_util_percent'] = avg_util_match.group(1).strip()\n","                        try:\n","                            content['market_notes']['avg_util_change'] = float(avg_util_match.group(2).replace('+', ''))\n","                        except (ValueError, TypeError):\n","                            content['market_notes']['avg_util_change'] = 0.0\n","                        print(f\"  Parsed Avg Utilization: {content['market_notes'].get('avg_util_percent')}, Change: {content['market_notes'].get('avg_util_change')}\")\n","                    elif lendable_match:\n","                        content['market_notes']['lendable_value'] = lendable_match.group(1).strip()\n","                        try:\n","                            content['market_notes']['lendable_value_change'] = float(lendable_match.group(2).replace('+', ''))\n","                        except (ValueError, TypeError):\n","                            content['market_notes']['lendable_value_change'] = 0.0\n","                        print(f\"  Parsed Lendable Value: {content['market_notes'].get('lendable_value')}, Change: {content['market_notes'].get('lendable_value_change')}\")\n","\n","\n","                if content['market_notes']:\n","                     print(f\"Finished parsing Market Notes table {i+1}. Content: {content['market_notes']}\")\n","                else:\n","                    print(f\"Table {i+1} did not contain recognizable Market Notes format in the first row.\")\n","\n","\n","            except Exception as e:\n","                print(f\"Warning: Could not parse Market Notes from table {i+1}. Error: {e}\")\n","        else:\n","             print(f\"Table {i+1} does not match criteria for Market Notes or other known tables.\")\n","\n","\n","    return content\n","\n","\n","# --- 2. HTML Generation ---\n","\n","def create_digest_html(content):\n","    \"\"\"\n","    Generates the final HTML for the digest by populating a template with the\n","    parsed content.\n","    \"\"\"\n","    if not content:\n","        return \"<h1>Error: Could not generate content because the source document could not be parsed.</h1>\"\n","\n","    # Helper function to format numeric changes with color\n","    def format_change(value, unit=' BPS', decimal_places=0):\n","        try:\n","            cleaned_value = str(value).replace(',', '').strip()\n","            val = float(cleaned_value)\n","            color = '#16a34a' if val > 0 else '#dc2626'\n","            sign = '+' if val > 0 else ''\n","            format_string = f'{{val:,.{decimal_places}f}}{{unit}}' if decimal_places > 0 else f'{{val:,.0f}}{{unit}}'\n","            return f'<span style=\"color:{color}; font-size:14px;\">{sign}{format_string.format(val=val, unit=unit)}</span>'\n","        except (ValueError, TypeError):\n","            return str(value).strip() if pd.notna(value) else ''\n","\n","    # Helper function for market note percentage changes\n","    def format_market_note_change(value):\n","        try:\n","            val = float(value)\n","            color = '#16a34a' if val >= 0 else '#dc2626'\n","            sign = '+' if val >= 0 else ''\n","            return f'<span style=\"color:{color}; font-size:14px;\">{sign}{val:.2f}%</span>'\n","        except (ValueError, TypeError):\n","            return str(value).strip() if pd.notna(value) else ''\n","\n","    # --- Prepare Market Notes ---\n","    market_notes = content.get('market_notes', {})\n","    avg_fee_bps = market_notes.get('avg_fee_bps', 'N/A')\n","    avg_fee_change_value = market_notes.get('avg_fee_change', 0)\n","    avg_fee_change = format_market_note_change(avg_fee_change_value) if isinstance(avg_fee_change_value, (int, float)) else 'N/A'\n","\n","    avg_util_percent = market_notes.get('avg_util_percent', 'N/A')\n","    avg_util_change_value = market_notes.get('avg_util_change', 0)\n","    avg_util_change = format_market_note_change(avg_util_change_value) if isinstance(avg_util_change_value, (int, float)) else 'N/A'\n","\n","    on_loan_value = market_notes.get('on_loan_value', 'N/A')\n","    on_loan_value_change_value = market_notes.get('on_loan_value_change', 0)\n","    on_loan_value_change = format_market_note_change(on_loan_value_change_value) if isinstance(on_loan_value_change_value, (int, float)) else 'N/A'\n","\n","    lendable_value = market_notes.get('lendable_value', 'N/A')\n","    lendable_value_change_value = market_notes.get('lendable_value_change', 0)\n","    lendable_value_change = format_market_note_change(lendable_value_change_value) if isinstance(lendable_value_change_value, (int, float)) else 'N/A'\n","\n","    # --- Prepare Headlines ---\n","    headlines_html = \"\"\n","    for headline in content.get('headlines', []):\n","        headlines_html += f\"\"\"\n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">{headline['title']}</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">{headline['description']}</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> {headline['data_insight']}</li>\n","            </ul>\n","        </div>\n","        \"\"\"\n","\n","    # --- Prepare \"Hot & Getting Hotter\" Table ---\n","    ht_borrow_html = \"\"\n","    for row in content.get('hot_stocks_data', []):\n","        price_val = row.get('price', '')\n","        formatted_price = f\"${price_val.replace('$', '')}\" if price_val else \"\"\n","        ht_borrow_html += f\"\"\"\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\">{row.get(\"ticker\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{row.get(\"company_name\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{row.get(\"industry\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{formatted_price}</td>\n","            <td style=\"padding:4px 8px;\">{format_change(row.get(\"fee_1_wow\", \"\"))}</td>\n","        </tr>\"\"\"\n","\n","    # --- Prepare \"Squeeze Metrics\" Table ---\n","    squeeze_html = \"\"\n","    for row in content.get('squeeze_stocks_data', []):\n","        price_val = row.get('price', '')\n","        formatted_price = f\"${price_val.replace('$', '')}\" if price_val else \"\"\n","        squeeze_html += f\"\"\"\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\">{row.get(\"ticker\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{row.get(\"company_name\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{row.get(\"industry\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{formatted_price}</td>\n","            <td style=\"padding:4px 8px;\">{row.get(\"short_squeeze_score\", \"\")}</td>\n","            <td style=\"padding:4px 8px;\">{format_change(row.get(\"sss_wow\", \"\"), unit=\"\", decimal_places=0)}</td>\n","        </tr>\"\"\"\n","\n","    # --- Prepare Key Takeaways ---\n","    takeaways_html = \"\".join([f\"<li>{item}</li>\" for item in content.get('key_takeaways', [])])\n","\n","    # --- Assemble Final HTML ---\n","    html_template = f\"\"\"\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - {datetime.now().strftime('%B %d, %Y')}</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">{datetime.now().strftime('%B %d, %Y')}</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      {avg_fee_bps} bps {avg_fee_change}\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      {avg_util_percent}% {avg_util_change}\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      ${on_loan_value} {on_loan_value_change}\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      ${lendable_value} {lendable_value_change}\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              {headlines_html}\n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  {ht_borrow_html}\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  {squeeze_html}\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                {takeaways_html}\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    \"\"\"\n","    return html_template\n","\n","# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","Table 2 did not contain recognizable Market Notes format in the first row.\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}],"execution_count":74,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"c5YWdJsLTdfo","executionInfo":{"status":"ok","timestamp":1754536639707,"user_tz":240,"elapsed":89,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"c17f9ea7-77b8-4810-aeb4-5902e61e0992"}},{"cell_type":"code","source":[],"metadata":{"id":"_1deCh0xWJMD","executionInfo":{"status":"ok","timestamp":1754536385822,"user_tz":240,"elapsed":14,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}}},"execution_count":61,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"30256d35","executionInfo":{"status":"ok","timestamp":1754536385846,"user_tz":240,"elapsed":37,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"1daffa50-569b-4107-9c54-abf0333c65b4"},"source":["from IPython.display import HTML, display\n","\n","\n","# Display the HTML content\n","display(HTML(final_html))\n","\n"],"execution_count":62,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                       bps <span style=\"color:#16a34a; font-size:14px;\">+74.90%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      % <span style=\"color:#16a34a; font-size:14px;\">+7.11%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.</li>\n","            </ul>\n","        </div>\n","        \n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                <li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li>\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"d9d21d73","executionInfo":{"status":"ok","timestamp":1754536385847,"user_tz":240,"elapsed":6,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"1dec9309-aa74-4742-ae2d-f76d4d6f6143"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":63,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"17aeb1b7","executionInfo":{"status":"ok","timestamp":1754536385879,"user_tz":240,"elapsed":31,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"e971e3a5-ba71-4ba5-ccfb-028f9fe1ced3"},"source":["display(parsed_content)"],"execution_count":64,"outputs":[{"output_type":"display_data","data":{"text/plain":["{'market_notes': {'avg_fee_bps': '',\n","  'avg_fee_change': 74.9,\n","  'avg_util_percent': '',\n","  'avg_util_change': 7.11},\n"," 'headlines': [{'title': 'Oil Prices Decline Amid OPEC+ Production and Demand Concerns',\n","   'description': 'Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.',\n","   'data_insight': 'With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.'},\n","  {'title': 'Chips and Semiconductors Underdogs Struggle to Keep Pace',\n","   'description': 'With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.',\n","   'data_insight': 'In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.'},\n","  {'title': 'European Equities Rise despite fresh tariff threats',\n","   'description': 'The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.',\n","   'data_insight': 'In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.'}],\n"," 'key_takeaways': ['Key takeaways 1', 'Key takeaways 2', 'Key takeaways 3'],\n"," 'hot_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD IN',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Fee_1_WoW_': '15,567'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Fee_1_WoW_': '5,447'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin',\n","   'Price': '$4.31',\n","   'Fee_1_WoW_': '12,527'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Srvc',\n","   'Price': '$2.02',\n","   'Fee_1_WoW_': '4,660'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals &Mining',\n","   'Price': '$12.35',\n","   'Fee_1_WoW_': '2,895'}],\n"," 'squeeze_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Short_Squeeze_Score_(SSS)': '100',\n","   'SSS_WoW': '1'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Short_Squeeze_Score_(SSS)': '99',\n","   'SSS_WoW': '2'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin’l',\n","   'Price': '$4.31',\n","   'Short_Squeeze_Score_(SSS)': '98',\n","   'SSS_WoW': '3'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Services',\n","   'Price': '$2.02',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '4'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals & Mining',\n","   'Price': '$12.35',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '5'}]}"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"32c1b144","executionInfo":{"status":"ok","timestamp":1754536385971,"user_tz":240,"elapsed":90,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"94854bbc-ec77-408b-a657-e8df6c10dace"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":65,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"1afe5b7f","executionInfo":{"status":"ok","timestamp":1754536385971,"user_tz":240,"elapsed":12,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"fa07c215-647b-4767-a614-07ab6e10f1aa"},"source":["display(parsed_content)"],"execution_count":66,"outputs":[{"output_type":"display_data","data":{"text/plain":["{'market_notes': {'avg_fee_bps': '',\n","  'avg_fee_change': 74.9,\n","  'avg_util_percent': '',\n","  'avg_util_change': 7.11},\n"," 'headlines': [{'title': 'Oil Prices Decline Amid OPEC+ Production and Demand Concerns',\n","   'description': 'Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.',\n","   'data_insight': 'With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.'},\n","  {'title': 'Chips and Semiconductors Underdogs Struggle to Keep Pace',\n","   'description': 'With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.',\n","   'data_insight': 'In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.'},\n","  {'title': 'European Equities Rise despite fresh tariff threats',\n","   'description': 'The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.',\n","   'data_insight': 'In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.'}],\n"," 'key_takeaways': ['Key takeaways 1', 'Key takeaways 2', 'Key takeaways 3'],\n"," 'hot_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD IN',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Fee_1_WoW_': '15,567'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Fee_1_WoW_': '5,447'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin',\n","   'Price': '$4.31',\n","   'Fee_1_WoW_': '12,527'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Srvc',\n","   'Price': '$2.02',\n","   'Fee_1_WoW_': '4,660'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals &Mining',\n","   'Price': '$12.35',\n","   'Fee_1_WoW_': '2,895'}],\n"," 'squeeze_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Short_Squeeze_Score_(SSS)': '100',\n","   'SSS_WoW': '1'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Short_Squeeze_Score_(SSS)': '99',\n","   'SSS_WoW': '2'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin’l',\n","   'Price': '$4.31',\n","   'Short_Squeeze_Score_(SSS)': '98',\n","   'SSS_WoW': '3'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Services',\n","   'Price': '$2.02',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '4'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals & Mining',\n","   'Price': '$12.35',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '5'}]}"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b1a67cbf","executionInfo":{"status":"ok","timestamp":1754536385982,"user_tz":240,"elapsed":19,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"1d9d15f2-b5a6-4851-8f59-2cdf25bb2c25"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":67,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"49cb324a","executionInfo":{"status":"ok","timestamp":1754536386016,"user_tz":240,"elapsed":29,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"2b8793fe-3625-4caa-fcaa-a922aa4a9d25"},"source":["from IPython.display import HTML, display\n","from google.colab import files\n","\n","# Display the HTML content\n","display(HTML(final_html))\n","\n","# Provide a download link\n","files.download(OUTPUT_HTML_PATH)"],"execution_count":68,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                       bps <span style=\"color:#16a34a; font-size:14px;\">+74.90%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      % <span style=\"color:#16a34a; font-size:14px;\">+7.11%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.</li>\n","            </ul>\n","        </div>\n","        \n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                <li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li>\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_6599b06e-df2e-413b-9535-cbe052bc0b07\", \"equilend_daily_digest_2025_08_07.html\", 13251)"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"661b58a2","executionInfo":{"status":"ok","timestamp":1754536386091,"user_tz":240,"elapsed":74,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"bf4a1d16-fa04-4c69-9c7d-f4bbfe8bdfe5"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":69,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"markdown","source":[],"metadata":{"id":"OM8h80F8hGjK"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"457dc744","executionInfo":{"status":"ok","timestamp":1754536386092,"user_tz":240,"elapsed":6,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"55d8fe3d-7bad-4c00-cd83-370946c619bf"},"source":["display(parsed_content)"],"execution_count":70,"outputs":[{"output_type":"display_data","data":{"text/plain":["{'market_notes': {'avg_fee_bps': '',\n","  'avg_fee_change': 74.9,\n","  'avg_util_percent': '',\n","  'avg_util_change': 7.11},\n"," 'headlines': [{'title': 'Oil Prices Decline Amid OPEC+ Production and Demand Concerns',\n","   'description': 'Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.',\n","   'data_insight': 'With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.'},\n","  {'title': 'Chips and Semiconductors Underdogs Struggle to Keep Pace',\n","   'description': 'With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.',\n","   'data_insight': 'In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.'},\n","  {'title': 'European Equities Rise despite fresh tariff threats',\n","   'description': 'The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.',\n","   'data_insight': 'In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.'}],\n"," 'key_takeaways': ['Key takeaways 1', 'Key takeaways 2', 'Key takeaways 3'],\n"," 'hot_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD IN',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Fee_1_WoW_': '15,567'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Fee_1_WoW_': '5,447'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin',\n","   'Price': '$4.31',\n","   'Fee_1_WoW_': '12,527'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Srvc',\n","   'Price': '$2.02',\n","   'Fee_1_WoW_': '4,660'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals &Mining',\n","   'Price': '$12.35',\n","   'Fee_1_WoW_': '2,895'}],\n"," 'squeeze_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Short_Squeeze_Score_(SSS)': '100',\n","   'SSS_WoW': '1'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Short_Squeeze_Score_(SSS)': '99',\n","   'SSS_WoW': '2'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin’l',\n","   'Price': '$4.31',\n","   'Short_Squeeze_Score_(SSS)': '98',\n","   'SSS_WoW': '3'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Services',\n","   'Price': '$2.02',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '4'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals & Mining',\n","   'Price': '$12.35',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '5'}]}"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"206189d3","executionInfo":{"status":"ok","timestamp":1754536386110,"user_tz":240,"elapsed":21,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"d6e80547-69df-4dc6-e550-57fd22f4fb5d"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":71,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","  Parsed Avg Fee: , Change: 74.9\n","  Parsed Avg Utilization: , Change: 7.11\n","Finished parsing Market Notes table 2. Content: {'avg_fee_bps': '', 'avg_fee_change': 74.9, 'avg_util_percent': '', 'avg_util_change': 7.11}\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"5088912c","executionInfo":{"status":"ok","timestamp":1754536386138,"user_tz":240,"elapsed":27,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"87d58d28-a961-4a29-85b4-618e738e2c85"},"source":["from IPython.display import HTML, display\n","from google.colab import files\n","\n","# Display the HTML content\n","display(HTML(final_html))\n","\n","# Provide a download link\n","files.download(OUTPUT_HTML_PATH)"],"execution_count":72,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                       bps <span style=\"color:#16a34a; font-size:14px;\">+74.90%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      % <span style=\"color:#16a34a; font-size:14px;\">+7.11%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.</li>\n","            </ul>\n","        </div>\n","        \n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                <li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li>\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_ff8ad46b-84fb-45e4-8465-5b089c5469a2\", \"equilend_daily_digest_2025_08_07.html\", 13251)"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"8dd70092","executionInfo":{"status":"ok","timestamp":1754536386172,"user_tz":240,"elapsed":32,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"079f94f4-3740-4dbc-c55c-50e1bbf80eb6"},"source":["from IPython.display import HTML, display\n","from google.colab import files\n","\n","# Display the HTML content\n","display(HTML(final_html))\n","\n","# Provide a download link\n","files.download(OUTPUT_HTML_PATH)"],"execution_count":73,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                       bps <span style=\"color:#16a34a; font-size:14px;\">+74.90%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      % <span style=\"color:#16a34a; font-size:14px;\">+7.11%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.</li>\n","            </ul>\n","        </div>\n","        \n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                <li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li>\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_6de03adf-c15c-4261-bcd5-7731754cd111\", \"equilend_daily_digest_2025_08_07.html\", 13251)"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3c9de773","executionInfo":{"status":"ok","timestamp":1754536650973,"user_tz":240,"elapsed":59,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"2ecca452-414c-4265-dc93-29c262067e5b"},"source":["# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"execution_count":75,"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","\n","--- Parsing Tables ---\n","Processing Table 1\n","Table 1 Header Cells: ['equilend d&a daily digest\\nmonth dd, yyyy']\n","Table 1 does not match criteria for Market Notes or other known tables.\n","Processing Table 2\n","Table 2 Header Cells: ['average fee:\\n74.9 bps\\n+93.8%\\non loan value:\\n$3.05t\\n+1.02%', 'average utilization:\\n7.11%\\n+0.11%\\ntotal lendable value:\\n$42.9t \\n+0.90%']\n","Identified Market Notes table (Table 2) based on index and cell count.\n","  Cell 1 text: 'Average Fee:\n","74.9 bps\n","+93.8%\n","On Loan Value:\n","$3.05T\n","+1.02%'\n","  Cell 2 text: 'Average Utilization:\n","7.11%\n","+0.11%\n","Total Lendable Value:\n","$42.9T \n","+0.90%'\n","Table 2 did not contain recognizable Market Notes format in the first row.\n","Processing Table 3\n","Table 3 Header Cells: ['ticker', 'company name', 'industry', 'price', 'fee 1 wow (bps)']\n","Identified 'Hot & Getting Hotter' table 3\n","Parsed 5 rows for Hot & Getting Hotter.\n","Processing Table 4\n","Table 4 Header Cells: ['ticker', 'company name', 'industry', 'price', 'short squeeze score (sss)', 'sss wow']\n","Identified 'Squeeze Metrics' table 4\n","Parsed 5 rows for Squeeze Metrics.\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"836e74d1","executionInfo":{"status":"ok","timestamp":1754536651479,"user_tz":240,"elapsed":49,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"dad4eb6f-fcc8-4d8f-9e60-b48ae411a34e"},"source":["display(parsed_content)"],"execution_count":76,"outputs":[{"output_type":"display_data","data":{"text/plain":["{'market_notes': {},\n"," 'headlines': [{'title': 'Oil Prices Decline Amid OPEC+ Production and Demand Concerns',\n","   'description': 'Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.',\n","   'data_insight': 'With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.'},\n","  {'title': 'Chips and Semiconductors Underdogs Struggle to Keep Pace',\n","   'description': 'With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.',\n","   'data_insight': 'In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.'},\n","  {'title': 'European Equities Rise despite fresh tariff threats',\n","   'description': 'The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.',\n","   'data_insight': 'In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.'}],\n"," 'key_takeaways': ['Key takeaways 1', 'Key takeaways 2', 'Key takeaways 3'],\n"," 'hot_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD IN',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Fee_1_WoW_': '15,567'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Fee_1_WoW_': '5,447'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin',\n","   'Price': '$4.31',\n","   'Fee_1_WoW_': '12,527'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Srvc',\n","   'Price': '$2.02',\n","   'Fee_1_WoW_': '4,660'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals &Mining',\n","   'Price': '$12.35',\n","   'Fee_1_WoW_': '2,895'}],\n"," 'squeeze_stocks_data': [{'Ticker': 'ABVE',\n","   'Company_Name': 'ABOVE FOOD',\n","   'Industry': 'Food, Bev, Tobacco',\n","   'Price': '$1.72',\n","   'Short_Squeeze_Score_(SSS)': '100',\n","   'SSS_WoW': '1'},\n","  {'Ticker': 'WBUY',\n","   'Company_Name': 'WEBUY GLOBAL',\n","   'Industry': 'Food & Staples',\n","   'Price': '$3.50',\n","   'Short_Squeeze_Score_(SSS)': '99',\n","   'SSS_WoW': '2'},\n","  {'Ticker': 'PAPL',\n","   'Company_Name': 'PINEAPPLE FIN’L',\n","   'Industry': 'Diversified Fin’l',\n","   'Price': '$4.31',\n","   'Short_Squeeze_Score_(SSS)': '98',\n","   'SSS_WoW': '3'},\n","  {'Ticker': 'BMGL',\n","   'Company_Name': 'BASEL MEDICAL',\n","   'Industry': 'Providers & Services',\n","   'Price': '$2.02',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '4'},\n","  {'Ticker': 'BGL',\n","   'Company_Name': 'BLUE GOLD',\n","   'Industry': 'Metals & Mining',\n","   'Price': '$12.35',\n","   'Short_Squeeze_Score_(SSS)': '96',\n","   'SSS_WoW': '5'}]}"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"db708770","executionInfo":{"status":"ok","timestamp":1754536652107,"user_tz":240,"elapsed":28,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"4504a1e5-862a-478d-9e6b-a0018c481cd3"},"source":["from IPython.display import HTML, display\n","from google.colab import files\n","\n","# Display the HTML content\n","display(HTML(final_html))\n","\n","# Provide a download link\n","files.download(OUTPUT_HTML_PATH)"],"execution_count":77,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#334155; font-size:14px; line-height:1.5;\">\n","\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4BC; Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      N/A bps <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      N/A% <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","                <tr>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                  <td align=\"center\" width=\"50%\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      $N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span>\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px; color:#0284c7;\">&#x1F4F0; Major Headlines and What Our Data Shows</h2>\n","              \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profit for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> With the middle eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights to 7.27 billion shares.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In contrary, some firms are clearly benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.</li>\n","            </ul>\n","        </div>\n","        \n","        <div style=\"margin-top:20px;\">\n","            <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","            <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","            <ul style=\"margin:10px 0 0; padding-left:20px; color:#334155; list-style-type: disc;\">\n","              <li><strong>What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. being in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee see as this time last year.</li>\n","            </ul>\n","        </div>\n","        \n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F525; Hot & Getting Hotter</h2>\n","              <div style=\"font-size:14px; font-style:italic; color:#334155; margin-bottom:10px; padding-left:5px;\">Top stocks with high and rising fees</div>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"5px 8px; white-space: nowrap;\">Fee 1 WoW (bps)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\" width=\"100%\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Ticker</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Company Name</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Industry</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Price</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">Short Squeeze Score (SSS)</th>\n","                    <th style=\"padding:5px 8px; white-space: nowrap;\">SSS WoW</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  \n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","        <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","            <td style=\"padding:4px 8px;\"></td>\n","        </tr>\n","                </tbody>\n","              </table>\n","\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px; color:#0284c7;\">&#x1F4A1; Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                <li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li>\n","              </ul>\n","\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#6474b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_e4dcba0f-c40b-43f2-93be-4fc46956c2b1\", \"equilend_daily_digest_2025_08_07.html\", 13256)"]},"metadata":{}}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}