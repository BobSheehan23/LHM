{"cells":[{"cell_type":"code","source":["pip install python-docx pandas openpyxl"],"metadata":{"id":"RcakN1_uthzV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# -*- coding: utf-8 -*-\n","\"\"\"\n","daily_digest_generator.py\n","\n","This script dynamically generates a daily HTML digest by parsing all content\n","and tables directly from a single Microsoft Word document. This version is\n","simplified and does not require any external API calls or keys.\n","\n","To run:\n","1. Make sure 'daily_content.docx' is in the same directory.\n","2. Install required libraries: pip install python-docx pandas openpyxl\n","3. Run the script from your terminal: python daily_digest_generator.py\n","\"\"\"\n","\n","import pandas as pd\n","import docx\n","from datetime import datetime\n","import re\n","\n","# --- Configuration ---\n","CONTENT_DOC_PATH = 'daily_content.docx'\n","OUTPUT_HTML_PATH = f\"equilend_daily_digest_{datetime.now().strftime('%Y_%m_%d')}.html\"\n","\n","# --- 1. DOCX Content Parsing ---\n","\n","def parse_daily_content(doc_path):\n","    \"\"\"\n","    Parses a .docx file for all text and table content, including market notes,\n","    headlines, key takeaways, and data tables. This function is designed to be\n","    resilient to minor formatting changes in the source document.\n","    \"\"\"\n","    try:\n","        document = docx.Document(doc_path)\n","    except Exception as e:\n","        print(f\"FATAL: Error opening or parsing DOCX file: {doc_path}. Error: {e}\")\n","        return None\n","\n","    content = {\n","        'market_notes': {}, 'headlines': [], 'key_takeaways': [],\n","        'hot_stocks_data': [], 'squeeze_stocks_data': []\n","    }\n","\n","    # --- Parse All Tables First ---\n","    # This approach is more robust as it identifies tables by their content/headers\n","    # regardless of their order in the document.\n","    for table in document.tables:\n","        if not table.rows:\n","            continue\n","\n","        # Extract header to identify the table type\n","        header_cells = [cell.text.strip().lower() for cell in table.rows[0].cells]\n","\n","        # A. Identify and parse \"Market Notes\" table\n","        # It has a unique structure, often with metrics like 'average fee:'\n","        if any('average fee' in h for h in header_cells):\n","            try:\n","                # This table might have a 2xN or Nx2 layout. We iterate through all cells.\n","                for row in table.rows:\n","                    row_text = [cell.text.strip() for cell in row.cells]\n","                    # Process cells in pairs: Metric, Value, Change\n","                    for i in range(0, len(row_text) - 1, 3):\n","                        metric = row_text[i].lower()\n","                        value = row_text[i+1]\n","                        change_str = row_text[i+2]\n","                        change_match = re.search(r'([+-]?\\d+\\.?\\d*)', change_str)\n","                        change = float(change_match.group(1)) if change_match else 0.0\n","\n","                        if 'average fee' in metric:\n","                            content['market_notes']['avg_fee_bps'] = value.replace('bps', '').strip()\n","                            content['market_notes']['avg_fee_change'] = change\n","                        elif 'average utilization' in metric:\n","                            content['market_notes']['avg_util_percent'] = value.replace('%', '').strip()\n","                            content['market_notes']['avg_util_change'] = change\n","                        elif 'on loan value' in metric:\n","                            content['market_notes']['on_loan_value'] = value.replace('$', '').strip()\n","                            content['market_notes']['on_loan_value_change'] = change\n","                        elif 'total lendable value' in metric:\n","                            content['market_notes']['lendable_value'] = value.replace('$', '').strip()\n","                            content['market_notes']['lendable_value_change'] = change\n","            except Exception as e:\n","                print(f\"Warning: Could not parse Market Notes from table. Error: {e}\")\n","            continue # Move to the next table\n","\n","        # B. Identify and parse \"Hot & Getting Hotter\" table\n","        if 'fee 1 wow (bps)' in header_cells:\n","            keys = [h.replace(' ', '_').replace('(', '').replace(')', '') for h in header_cells]\n","            for row in table.rows[1:]:\n","                row_data = {keys[i]: cell.text.strip() for i, cell in enumerate(row.cells)}\n","                content['hot_stocks_data'].append(row_data)\n","            continue\n","\n","        # C. Identify and parse \"Squeeze Metrics\" table\n","        if 'short squeeze score (sss)' in header_cells:\n","            keys = [h.replace(' ', '_').replace('(', '').replace(')', '') for h in header_cells]\n","            for row in table.rows[1:]:\n","                row_data = {keys[i]: cell.text.strip() for i, cell in enumerate(row.cells)}\n","                content['squeeze_stocks_data'].append(row_data)\n","            continue\n","\n","    # --- Parse Paragraphs for Text Content ---\n","    paras = [p.text.strip() for p in document.paragraphs if p.text.strip()]\n","    current_section = None\n","    current_headline = {}\n","\n","    for p_text in paras:\n","        p_lower = p_text.lower()\n","\n","        # Section detection\n","        if 'major headlines' in p_lower:\n","            current_section = 'headlines'\n","            if current_headline: # Save previous headline\n","                content['headlines'].append(current_headline)\n","                current_headline = {}\n","            continue\n","        elif 'key takeaways' in p_lower:\n","            current_section = 'takeaways'\n","            if current_headline: # Save final headline\n","                content['headlines'].append(current_headline)\n","                current_headline = {}\n","            continue\n","        elif any(x in p_lower for x in ['market notes', 'hot & getting hotter', 'squeeze metrics']):\n","            current_section = None # Stop parsing paragraphs when a table section is hit\n","            continue\n","\n","        # Content parsing based on current section\n","        if current_section == 'headlines':\n","            if 'what our data shows:' in p_lower:\n","                current_headline['data_insight'] = re.sub(r'what our data shows:\\s?', '', p_text, flags=re.I).strip()\n","                if current_headline.get('title'): # Ensure there's a title before saving\n","                    content['headlines'].append(current_headline)\n","                    current_headline = {}\n","            elif not current_headline.get('title'):\n","                current_headline['title'] = p_text\n","                current_headline['description'] = []\n","            else:\n","                current_headline['description'].append(p_text)\n","\n","        elif current_section == 'takeaways':\n","            content['key_takeaways'].append(p_text.lstrip('-•* ').strip())\n","\n","    # Consolidate headline descriptions\n","    for h in content['headlines']:\n","        if isinstance(h.get('description'), list):\n","            h['description'] = \"\\n\".join(h['description'])\n","\n","    return content\n","\n","\n","# --- 2. HTML Generation ---\n","\n","def create_digest_html(content):\n","    \"\"\"\n","    Generates the final HTML for the digest by populating a template.\n","    \"\"\"\n","    if not content:\n","        return \"<h1>Error: Could not generate content from the source document.</h1>\"\n","\n","    # Helper functions for formatting\n","    def format_change(value, unit=' BPS', dec=0):\n","        try:\n","            val = float(str(value).replace(',', '').strip())\n","            color = '#16a34a' if val > 0 else '#dc2626'\n","            sign = '+' if val > 0 else ''\n","            return f'<span style=\"color:{color}; font-weight:500;\">{sign}{val:,.{dec}f}{unit}</span>'\n","        except (ValueError, TypeError):\n","            return str(value).strip() if pd.notna(value) else ''\n","\n","    def format_market_note_change(value):\n","        color = '#16a34a' if value >= 0 else '#dc2626'\n","        sign = '+' if value >= 0 else ''\n","        return f'<span style=\"color:{color}; font-size:14px; font-weight:500;\">{sign}{value:.2f}%</span>'\n","\n","    # Prepare Market Notes\n","    market_notes = content.get('market_notes', {})\n","    avg_fee_change = format_market_note_change(market_notes.get('avg_fee_change', 0))\n","    avg_util_change = format_market_note_change(market_notes.get('avg_util_change', 0))\n","    on_loan_change = format_market_note_change(market_notes.get('on_loan_value_change', 0))\n","    lendable_change = format_market_note_change(market_notes.get('lendable_value_change', 0))\n","\n","    # Prepare Headlines\n","    headlines_html = \"\".join([f\"\"\"\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px; color:#1e3a8a;\">{h['title']}</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap; line-height:1.6;\">{h.get('description', '')}</p>\n","        <div style=\"margin:12px 0 0; padding:12px; background-color:#f0f9ff; border-left: 3px solid #0284c7; border-radius: 0 4px 4px 0;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> {h.get('data_insight', 'N/A')}\n","        </div>\n","    </div>\"\"\" for h in content.get('headlines', [])])\n","\n","    # Prepare \"Hot & Getting Hotter\" Table\n","    ht_borrow_html = \"\".join([f\"\"\"\n","    <tr style=\"font-size:12px; background-color:#ffffff; text-align:left; border-bottom: 1px solid #e2e8f0;\">\n","        <td style=\"padding:8px;\">{r.get(\"ticker\", \"\")}</td>\n","        <td style=\"padding:8px;\">{r.get(\"company_name\", \"\")}</td>\n","        <td style=\"padding:8px;\">{r.get(\"industry\", \"\")}</td>\n","        <td style=\"padding:8px;\">${r.get(\"price\", \"\").replace('$', '')}</td>\n","        <td style=\"padding:8px;\">{format_change(r.get(\"fee_1_wow_bps\", \"\"))}</td>\n","    </tr>\"\"\" for r in content.get('hot_stocks_data', [])])\n","\n","    # Prepare \"Squeeze Metrics\" Table\n","    squeeze_html = \"\".join([f\"\"\"\n","    <tr style=\"font-size:12px; background-color:#ffffff; text-align:left; border-bottom: 1px solid #e2e8f0;\">\n","        <td style=\"padding:8px;\">{r.get(\"ticker\", \"\")}</td>\n","        <td style=\"padding:8px;\">{r.get(\"company_name\", \"\")}</td>\n","        <td style=\"padding:8px;\">{r.get(\"industry\", \"\")}</td>\n","        <td style=\"padding:8px;\">${r.get(\"price\", \"\").replace('$', '')}</td>\n","        <td style=\"padding:8px;\">{r.get(\"short_squeeze_score_sss\", \"\")}</td>\n","        <td style=\"padding:8px;\">{format_change(r.get(\"sss_wow\", \"\"), unit=\"\", dec=0)}</td>\n","    </tr>\"\"\" for r in content.get('squeeze_stocks_data', [])])\n","\n","    # Prepare Key Takeaways\n","    takeaways_html = \"\".join([f'<li style=\"margin-bottom:8px;\">{item}</li>' for item in content.get('key_takeaways', [])])\n","\n","    # --- Assemble Final HTML with EquiLend Branding ---\n","    html_template = f\"\"\"\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - {datetime.now().strftime('%B %d, %Y')}</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr><td align=\"center\">\n","    <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:8px; overflow:hidden; border: 1px solid #e2e8f0;\">\n","      <!-- Header -->\n","      <tr><td bgcolor=\"#0c4a6e\" style=\"padding:20px; text-align:center;\">\n","          <h1 style=\"margin:0; font-size:24px; color:#ffffff; font-weight:600;\">EquiLend D&A Daily Digest</h1>\n","          <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">{datetime.now().strftime('%B %d, %Y')}</p>\n","      </td></tr>\n","      <!-- Main Content -->\n","      <tr><td style=\"padding:24px; color:#334155; font-size:14px; line-height:1.6;\">\n","\n","          <!-- Market Notes -->\n","          <h2 style=\"font-size:18px; margin:0 0 12px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4BC; Market Notes</h2>\n","          <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:25px; border-radius:6px;\">\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">{market_notes.get('avg_fee_bps', 'N/A')} bps {avg_fee_change}</p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">{market_notes.get('avg_util_percent', 'N/A')}% {avg_util_change}</p></td>\n","            </tr>\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">${market_notes.get('on_loan_value', 'N/A')} {on_loan_change}</p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">${market_notes.get('lendable_value', 'N/A')} {lendable_change}</p></td>\n","            </tr>\n","          </table>\n","\n","          <!-- Headlines -->\n","          <h2 style=\"font-size:18px; margin:0 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4F0; Major Headlines</h2>\n","          {headlines_html}\n","\n","          <!-- Tables Section -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F525; Hot & Getting Hotter</h2>\n","          <div style=\"font-size:12px; font-style:italic; color:#64748b; margin-bottom:10px;\">Top stocks with high and rising fees, indicating increased short interest.</div>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px 8px; border-bottom: 2px solid #e2e8f0;\">Ticker</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Company</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Industry</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Price</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Fee 1W Change</th></tr></thead>\n","            <tbody>{ht_borrow_html}</tbody>\n","          </table>\n","\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Ticker</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Company</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Industry</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Price</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">SSS</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">SSS WoW</th></tr></thead>\n","            <tbody>{squeeze_html}</tbody>\n","          </table>\n","\n","          <!-- Key Takeaways -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4A1; Key Takeaways</h2>\n","          <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0; list-style-type:disc;\">{takeaways_html}</ul>\n","\n","      </td></tr>\n","      <!-- Footer -->\n","      <tr><td align=\"center\" style=\"padding:15px; font-size:12px; color:#64748b; background-color:#f8fafc; border-top: 1px solid #e2e8f0;\">\n","          Source: EquiLend Data &amp; Analytics\n","      </td></tr>\n","    </table>\n","    </td></tr>\n","  </table>\n","</body>\n","</html>\n","    \"\"\"\n","    return html_template\n","\n","# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors. Please check the Word document format.\")"],"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","Warning: Could not parse Market Notes from table. Error: list index out of range\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}],"execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hxNADjKktObu","executionInfo":{"status":"ok","timestamp":1754539641879,"user_tz":240,"elapsed":1055,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"51c9816b-c29b-4818-8c76-154aef4d2948"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"9e15eba0","executionInfo":{"status":"ok","timestamp":1754539672079,"user_tz":240,"elapsed":45,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"fbc3be63-b916-4dd5-b9e9-893f67f81fae"},"source":["from IPython.display import HTML\n","import os\n","\n","# Define the path to the generated HTML file\n","OUTPUT_HTML_PATH = f\"equilend_daily_digest_{datetime.now().strftime('%Y_%m_%d')}.html\"\n","\n","# Check if the file exists before attempting to display\n","if os.path.exists(OUTPUT_HTML_PATH):\n","    with open(OUTPUT_HTML_PATH, 'r', encoding='utf-8') as f:\n","        html_content = f.read()\n","    display(HTML(html_content))\n","else:\n","    print(f\"HTML file not found: {OUTPUT_HTML_PATH}\")\n","    print(\"Please run the script to generate the HTML file first.\")"],"execution_count":3,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr><td align=\"center\">\n","    <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:8px; overflow:hidden; border: 1px solid #e2e8f0;\">\n","      <!-- Header -->\n","      <tr><td bgcolor=\"#0c4a6e\" style=\"padding:20px; text-align:center;\">\n","          <h1 style=\"margin:0; font-size:24px; color:#ffffff; font-weight:600;\">EquiLend D&A Daily Digest</h1>\n","          <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","      </td></tr>\n","      <!-- Main Content -->\n","      <tr><td style=\"padding:24px; color:#334155; font-size:14px; line-height:1.6;\">\n","\n","          <!-- Market Notes -->\n","          <h2 style=\"font-size:18px; margin:0 0 12px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4BC; Market Notes</h2>\n","          <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:25px; border-radius:6px;\">\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">N/A bps <span style=\"color:#16a34a; font-size:14px; font-weight:500;\">+0.00%</span></p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">N/A% <span style=\"color:#16a34a; font-size:14px; font-weight:500;\">+0.00%</span></p></td>\n","            </tr>\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">$N/A <span style=\"color:#16a34a; font-size:14px; font-weight:500;\">+0.00%</span></p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">$N/A <span style=\"color:#16a34a; font-size:14px; font-weight:500;\">+0.00%</span></p></td>\n","            </tr>\n","          </table>\n","\n","          <!-- Headlines -->\n","          <h2 style=\"font-size:18px; margin:0 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4F0; Major Headlines</h2>\n","          \n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px; color:#1e3a8a;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap; line-height:1.6;\">Crude oil prices have fallen, with reports indicating that profits for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","        <div style=\"margin:12px 0 0; padding:12px; background-color:#f0f9ff; border-left: 3px solid #0284c7; border-radius: 0 4px 4px 0;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> With the Middle Eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on-loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights of 7.27 billion shares.\n","        </div>\n","    </div>\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px; color:#1e3a8a;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap; line-height:1.6;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so, but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","        <div style=\"margin:12px 0 0; padding:12px; background-color:#f0f9ff; border-left: 3px solid #0284c7; border-radius: 0 4px 4px 0;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> On the contrary, some firms are benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.\n","        </div>\n","    </div>\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px; color:#1e3a8a;\">European Equities Rise despite fresh tariff threats</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap; line-height:1.6;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","        <div style=\"margin:12px 0 0; padding:12px; background-color:#f0f9ff; border-left: 3px solid #0284c7; border-radius: 0 4px 4px 0;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee seen as this time last year.\n","        </div>\n","    </div>\n","\n","          <!-- Tables Section -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F525; Hot & Getting Hotter</h2>\n","          <div style=\"font-size:12px; font-style:italic; color:#64748b; margin-bottom:10px;\">Top stocks with high and rising fees, indicating increased short interest.</div>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px 8px; border-bottom: 2px solid #e2e8f0;\">Ticker</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Company</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Industry</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Price</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Fee 1W Change</th></tr></thead>\n","            <tbody></tbody>\n","          </table>\n","\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Ticker</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Company</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Industry</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">Price</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">SSS</th><th style=\"padding:8px; border-bottom: 2px solid #e2e8f0;\">SSS WoW</th></tr></thead>\n","            <tbody></tbody>\n","          </table>\n","\n","          <!-- Key Takeaways -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px;\">&#x1F4A1; Key Takeaways</h2>\n","          <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0; list-style-type:disc;\"></ul>\n","\n","      </td></tr>\n","      <!-- Footer -->\n","      <tr><td align=\"center\" style=\"padding:15px; font-size:12px; color:#64748b; background-color:#f8fafc; border-top: 1px solid #e2e8f0;\">\n","          Source: EquiLend Data &amp; Analytics\n","      </td></tr>\n","    </table>\n","    </td></tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}