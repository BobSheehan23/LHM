{"cells":[{"cell_type":"code","source":["import pandas as pd\n","import os\n","\n","# --- Configuration ---\n","# This dictionary maps your original CSV filenames to the clean tab names\n","# you want in the final Excel file.\n","# Add or remove files from this dictionary as needed.\n","files_to_consolidate = {\n","    # Global Data\n","    'all_etfs_jun_30_2025_2025-07-10_bsheehan_adhoc.csv': 'Global_ETFs_June_2025',\n","    'all_atfs_jan1_2025-07-10_bsheehan_adhoc.csv': 'Global_ETFs_Jan_2025',\n","    'all_etf_july_30_2023_2025-07-10_bsheehan_adhoc.csv': 'Global_ETFs_July_2023',\n","\n","    # North America Data\n","    'northam_etfs_jun2025_2025-07-10_bsheehan_adhoc.csv': 'NorthAm_ETFs_June_2025',\n","    'jan2025northametfs_2025-07-10_bsheehan_adhoc.csv': 'NorthAm_ETFs_Jan_2025',\n","    'all_northam_etf_jul2023_bsheehan_adhoc.csv': 'NorthAm_ETFs_July_2023',\n","\n","    # Additional Data\n","    'on loan act len qty etfs.csv': 'OnLoan_ActiveLend_Qty'\n","}\n","\n","output_filename = 'EquiLend_ETF_Consolidated_Data.xlsx'\n","\n","# --- Main Script ---\n","def create_consolidated_spreadsheet():\n","    \"\"\"\n","    Reads multiple CSV files and consolidates them into a single Excel\n","    spreadsheet with each CSV on a separate, cleanly-named tab.\n","    \"\"\"\n","    try:\n","        # Create an Excel writer object using the openpyxl engine\n","        with pd.ExcelWriter(output_filename, engine='openpyxl') as writer:\n","            print(f\"Creating Excel file: {output_filename}\")\n","\n","            # Loop through the dictionary of files\n","            for csv_file, sheet_name in files_to_consolidate.items():\n","                # Check if the source CSV file exists before trying to read it\n","                if os.path.exists(csv_file):\n","                    print(f\"  - Reading '{csv_file}'...\")\n","                    # Read the CSV into a pandas DataFrame\n","                    df = pd.read_csv(csv_file)\n","\n","                    print(f\"  - Writing to sheet: '{sheet_name}'...\")\n","                    # Write the DataFrame to a new sheet in the Excel file\n","                    # index=False prevents pandas from writing the DataFrame index as a column\n","                    df.to_excel(writer, sheet_name=sheet_name, index=False)\n","                else:\n","                    print(f\"  - WARNING: File not found - '{csv_file}'. Skipping.\")\n","\n","        print(f\"\\nSuccessfully created '{output_filename}'\")\n","\n","    except Exception as e:\n","        print(f\"\\nAn error occurred: {e}\")\n","\n","# --- Execute the function ---\n","if __name__ == \"__main__\":\n","    create_consolidated_spreadsheet()"],"outputs":[{"output_type":"stream","name":"stdout","text":["Creating Excel file: EquiLend_ETF_Consolidated_Data.xlsx\n","  - Reading 'all_etfs_jun_30_2025_2025-07-10_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'Global_ETFs_June_2025'...\n","  - Reading 'all_atfs_jan1_2025-07-10_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'Global_ETFs_Jan_2025'...\n","  - Reading 'all_etf_july_30_2023_2025-07-10_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'Global_ETFs_July_2023'...\n","  - Reading 'northam_etfs_jun2025_2025-07-10_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'NorthAm_ETFs_June_2025'...\n","  - Reading 'jan2025northametfs_2025-07-10_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'NorthAm_ETFs_Jan_2025'...\n","  - Reading 'all_northam_etf_jul2023_bsheehan_adhoc.csv'...\n","  - Writing to sheet: 'NorthAm_ETFs_July_2023'...\n","  - Reading 'on loan act len qty etfs.csv'...\n","  - Writing to sheet: 'OnLoan_ActiveLend_Qty'...\n","\n","Successfully created 'EquiLend_ETF_Consolidated_Data.xlsx'\n"]}],"execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"85OsdFjz5fz7","executionInfo":{"status":"ok","timestamp":1752143683698,"user_tz":240,"elapsed":18792,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"51c19c90-1be4-43b3-9d2d-639adead4783"}}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}