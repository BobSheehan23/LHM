{"cells":[{"cell_type":"code","source":["import os\n","\n","# --- DATA FOR THE REPORT ---\n","# This data is for the July 18, 2025 report.\n","\n","REPORT_DATE = \"July 18, 2025\"\n","\n","MARKET_NOTES = {\n","    \"fee\": \"46.1 bps\",\n","    \"fee_change\": \"-0.24%\",\n","    \"fee_direction\": \"down\",\n","    \"utilization\": \"7.13%\",\n","    \"utilization_change\": \"-1.37%\",\n","    \"utilization_direction\": \"down\"\n","}\n","\n","HEADLINES = [\n","    {\n","        \"title\": \"Trump Backs Down on Fed Chair Threats, Easing Market Jitters\",\n","        \"body\": \"Following a week of speculation, President Trump stated he is not actively considering the removal of Federal Reserve Chair Jerome Powell. The announcement led to a relief rally in U.S. Treasurys and a strengthening of the dollar, as markets priced out the immediate risk of a disruptive change in Fed leadership.\",\n","        \"data_shows\": \"Coinciding with the tempered political rhetoric, the U.S. Financials sector has seen a notable decrease in shares on loan over the last 48 hours, falling by approximately 35 million shares. This reduction in short interest could suggest that institutional investors are unwinding hedges that were put in place to protect against potential policy uncertainty.\"\n","    },\n","    {\n","        \"title\": \"Global Markets Await Key Inflation Data\",\n","        \"body\": \"Investors are bracing for a series of critical inflation reports next week, with CPI data due from the United States, United Kingdom, and the European Union. These figures will be crucial in shaping central bank policy expectations for the remainder of the year, with analysts divided on whether persistent price pressures will force a more hawkish stance.\",\n","        \"data_shows\": \"Ahead of the inflation data releases, our data shows a marked increase in on-loan values for both the consumer staples and consumer discretionary sectors globally. This dual rise may indicate that investors are hedging their portfolios against binary outcomesâ€”protecting against a downturn in case of a high inflation print, while also positioning for a potential rally if the data comes in cooler than expected.\"\n","    },\n","    {\n","        \"title\": \"AI-Driven Rally Faces First Test with Tech Earnings\",\n","        \"body\": \"The market's AI-fueled enthusiasm is set to be tested as several big-name technology companies are scheduled to report quarterly earnings next week. The results are expected to provide the first concrete evidence of how AI investments are translating into revenue and profit growth, with market leadership at stake.\",\n","        \"data_shows\": \"Borrowing costs for the U.S. Information Technology sector have risen from an average of 75 bps to 95 bps over the past two weeks. This uptick in the cost to borrow could signal that some market participants are positioning for potential volatility or are taking profits by hedging long positions ahead of these key earnings announcements.\"\n","    }\n","]\n","\n","# Top 5 from fee_1_with_week_diff_2025-07-18_bsheehan_adhoc.csv with positive WoW momentum\n","HARD_TO_BORROW_DATA = [\n","    {\"ticker\": \"AEMD\", \"name\": \"AETHEMED INC COM\", \"industry\": \"Pharmaceuticals, Biotechnology & Life Sciences\", \"fee\": \"12,170.83\", \"momentum\": \"+12,171 BPS\", \"momentum_direction\": \"up\"},\n","    {\"ticker\": \"WBUY\", \"name\": \"WEBUY GLOBAL LTD COM (POST SPT)\", \"industry\": \"Food & Staples Retailing\", \"fee\": \"8,999.00\", \"momentum\": \"+8,999 BPS\", \"momentum_direction\": \"up\"},\n","    {\"ticker\": \"SLRX\", \"name\": \"SALARIUS PHARMACEUTICALS INC COM (POST REV SPL\", \"industry\": \"Pharmaceuticals, Biotechnology & Life Sciences\", \"fee\": \"8,999.00\", \"momentum\": \"+8,999 BPS\", \"momentum_direction\": \"up\"},\n","    {\"ticker\": \"OP\", \"name\": \"OCEANPAL INC ORD (POST REV SPLT)\", \"industry\": \"Transportation\", \"fee\": \"8,999.00\", \"momentum\": \"+8,999 BPS\", \"momentum_direction\": \"up\"},\n","    {\"ticker\": \"FOXX\", \"name\": \"FOXX DEVELOPMENT HOLDINGS INC COM\", \"industry\": \"Technology Hardware & Equipment\", \"fee\": \"8,999.00\", \"momentum\": \"+8,999 BPS\", \"momentum_direction\": \"up\"},\n","]\n","\n","# Top 5 from squeeze_2025-07-18_bsheehan_adhoc.csv with positive WoW momentum\n","SHORT_SQUEEZE_DATA = [\n","    {\"ticker\": \"DJT\", \"name\": \"Trump Media & Technology Group Corp.\", \"industry\": \"Media & Entertainment\", \"price\": \"48.50\", \"score\": \"99.2\", \"score_wow\": \"+0.10\", \"score_direction\": \"up\"},\n","    {\"ticker\": \"RIVN\", \"name\": \"Rivian Automotive, Inc.\", \"industry\": \"Automobiles & Components\", \"price\": \"15.90\", \"score\": \"89.1\", \"score_wow\": \"+0.60\", \"score_direction\": \"up\"},\n","    {\"ticker\": \"BTCS\", \"name\": \"BTCS Inc.\", \"industry\": \"Software & Services\", \"price\": \"5.76\", \"score\": \"83.0\", \"score_wow\": \"+33.00\", \"score_direction\": \"up\"},\n","    {\"ticker\": \"GALT\", \"name\": \"Galectin Therapeutics Inc.\", \"industry\": \"Pharmaceuticals, Biotechnology & Life Sciences\", \"price\": \"2.85\", \"score\": \"79.0\", \"score_wow\": \"+10.00\", \"score_direction\": \"up\"},\n","    {\"ticker\": \"LXRX\", \"name\": \"Lexicon Pharmaceuticals, Inc.\", \"industry\": \"Pharmaceuticals, Biotechnology & Life Sciences\", \"price\": \"1.29\", \"score\": \"79.0\", \"score_wow\": \"+28.00\", \"score_direction\": \"up\"},\n","]\n","\n","\n","KEY_TAKEAWAYS = [\n","    \"The easing of political pressure on the Fed appears to correspond with a reduction in short interest in the U.S. Financials sector, as shown by the recent decrease in shares on loan.\",\n","    \"Ahead of key global inflation data, our data shows rising on-loan values in consumer-facing sectors, which may indicate that investors are actively hedging against potential market volatility.\",\n","    \"As major tech companies prepare to report earnings, the increase in borrowing costs for the sector could suggest that some market participants are positioning for potential price swings or are less confident in the continuation of the AI-driven rally.\"\n","]\n","\n","# --- HTML GENERATION FUNCTIONS (INLINE STYLES) ---\n","\n","def get_change_span_inline(change_value, direction):\n","    \"\"\"Returns a styled span for the change value.\"\"\"\n","    color = \"#16a34a\" if direction == \"up\" else \"#dc2626\"\n","    return f'<span style=\"color:{color}; font-size:14px;\">{change_value}</span>'\n","\n","def generate_market_notes_html_inline(notes):\n","    \"\"\"Generates the HTML for the Market Notes section with inline styles.\"\"\"\n","    fee_change_span = get_change_span_inline(notes['fee_change'], notes['fee_direction'])\n","    util_change_span = get_change_span_inline(notes['utilization_change'], notes['utilization_direction'])\n","\n","    return f\"\"\"\n","              <!-- Market Notes -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px;\">ðŸ“ˆ Market Notes</h2>\n","              <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px;\">\n","                <tr>\n","                  <td align=\"center\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      {notes['fee']} {fee_change_span}\n","                    </p>\n","                  </td>\n","                  <td align=\"center\">\n","                    <p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p>\n","                    <p style=\"margin:5px 0 0; font-size:18px; font-weight:bold; color:#334155;\">\n","                      {notes['utilization']} {util_change_span}\n","                    </p>\n","                  </td>\n","                </tr>\n","              </table>\n","    \"\"\"\n","\n","def generate_headlines_html_inline(headlines_data):\n","    \"\"\"Generates the HTML for the Major Headlines section with inline styles.\"\"\"\n","    articles_html = \"\"\n","    for i, headline in enumerate(headlines_data):\n","        margin_top = 'margin-top:20px;' if i > 0 else ''\n","        articles_html += f\"\"\"\n","              <div style=\"{margin_top}\">\n","                <strong style=\"font-size:16px;\">{headline['title']}</strong>\n","                <p style=\"margin:5px 0 0;\">{headline['body']}</p>\n","                <blockquote style=\"margin:10px 0 0; padding-left:10px; border-left:4px solid #7e22ce; color:#334155;\">\n","                  <strong>What Our Data Shows:</strong><br>\n","                  {headline['data_shows']}\n","                </blockquote>\n","              </div>\n","        \"\"\"\n","    return f\"\"\"\n","              <!-- Headlines -->\n","              <h2 style=\"font-size:18px; margin-bottom:10px;\">ðŸ“° Major Headlines and What Our Data Shows</h2>\n","              {articles_html}\n","    \"\"\"\n","\n","def generate_htb_table_html_inline(data):\n","    \"\"\"Generates the HTML for the Hard-to-Borrow table with inline styles.\"\"\"\n","    if not data:\n","        return \"<p><i>Hard-to-Borrow table data is pending.</i></p>\"\n","    rows_html = \"\"\n","    for row in data:\n","        momentum_span = get_change_span_inline(row['momentum'], row['momentum_direction'])\n","        rows_html += f\"\"\"\n","                  <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","                    <td style=\"padding:4px 8px;\">{row['ticker']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['name']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['industry']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['fee']}</td>\n","                    <td style=\"padding:4px 8px;\">{momentum_span}</td>\n","                  </tr>\n","        \"\"\"\n","    return f\"\"\"\n","              <!-- Hard-to-Borrow Table -->\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; margin-bottom:20px; border-color:#dddddd; font-size:12px;\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px;\">Ticker</th>\n","                    <th style=\"padding:5px 8px;\">Name</th>\n","                    <th style=\"padding:5px 8px;\">Industry</th>\n","                    <th style=\"padding:5px 8px;\">Fee (BPS)</th>\n","                    <th style=\"padding:5px 8px;\">Momentum (WoW)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  {rows_html}\n","                </tbody>\n","              </table>\n","    \"\"\"\n","\n","def generate_squeeze_table_html_inline(data):\n","    \"\"\"Generates the HTML for the Short Squeeze table with inline styles.\"\"\"\n","    if not data:\n","        return \"<p><i>Market Technicals & Squeeze Metrics table data is pending.</i></p>\"\n","    rows_html = \"\"\n","    for row in data:\n","        score_wow_span = get_change_span_inline(row['score_wow'], row['score_direction'])\n","        rows_html += f\"\"\"\n","                  <tr style=\"font-size:12px; background-color:#ffffff; text-align:left;\">\n","                    <td style=\"padding:4px 8px;\">{row['ticker']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['name']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['industry']}</td>\n","                    <td style=\"padding:4px 8px;\">${row['price']}</td>\n","                    <td style=\"padding:4px 8px;\">{row['score']}</td>\n","                    <td style=\"padding:4px 8px;\">{score_wow_span}</td>\n","                  </tr>\n","        \"\"\"\n","    return f\"\"\"\n","              <!-- Short Squeeze Table -->\n","              <table cellpadding=\"0\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; border-color:#dddddd; font-size:12px;\">\n","                <thead>\n","                  <tr bgcolor=\"#0284c7\" style=\"color:#ffffff; font-weight:bold; text-align:left;\">\n","                    <th style=\"padding:5px 8px;\">Ticker</th>\n","                    <th style=\"padding:5px 8px;\">Company Name</th>\n","                    <th style=\"padding:5px 8px;\">Industry</th>\n","                    <th style=\"padding:5px 8px;\">Price</th>\n","                    <th style=\"padding:5px 8px;\">Short Squeeze Score</th>\n","                    <th style=\"padding:5px 8px;\">Score (WoW)</th>\n","                  </tr>\n","                </thead>\n","                <tbody>\n","                  {rows_html}\n","                </tbody>\n","              </table>\n","    \"\"\"\n","\n","def generate_takeaways_html_inline(takeaways_data):\n","    \"\"\"Generates the HTML for the Key Takeaways section with inline styles.\"\"\"\n","    list_items_html = \"\"\n","    for item in takeaways_data:\n","        list_items_html += f\"<li>{item}</li>\\n\"\n","\n","    return f\"\"\"\n","              <!-- Key Takeaways -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px;\">ðŸ’¡ Key Takeaways</h2>\n","              <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">\n","                {list_items_html}\n","              </ul>\n","    \"\"\"\n","\n","def create_report_html_inline(date, market_notes, headlines, htb_data, squeeze_data, takeaways):\n","    \"\"\"Assembles the full HTML document from all the pieces using inline styles.\"\"\"\n","\n","    market_notes_section = generate_market_notes_html_inline(market_notes)\n","    headlines_section = generate_headlines_html_inline(headlines)\n","    htb_table_section = generate_htb_table_html_inline(htb_data)\n","    squeeze_table_section = generate_squeeze_table_html_inline(squeeze_data)\n","    takeaways_section = generate_takeaways_html_inline(takeaways)\n","\n","    full_html = f\"\"\"<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - {date}</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr>\n","      <td align=\"center\">\n","        <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:4px; overflow:hidden;\">\n","          <!-- Header -->\n","          <tr>\n","            <td bgcolor=\"#0284c7\" style=\"padding:20px; text-align:center;\">\n","              <h1 style=\"margin:0; font-size:24px; color:#ffffff;\">EquiLend D&amp;A Daily Digest</h1>\n","              <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">{date}</p>\n","            </td>\n","          </tr>\n","          <!-- Content -->\n","          <tr>\n","            <td style=\"padding:20px; color:#333333; font-size:14px; line-height:1.5;\">\n","              {market_notes_section}\n","              {headlines_section}\n","\n","              <!-- Tables Section -->\n","              <h2 style=\"font-size:18px; margin:20px 0 10px;\">ðŸ“Š Today's Specials and Hard-to-Borrow</h2>\n","              {htb_table_section}\n","\n","              <h2 style=\"font-size:18px; margin:20px 0 10px;\">ðŸ“‰ Market Technicals & Squeeze Metrics</h2>\n","              {squeeze_table_section}\n","\n","              {takeaways_section}\n","            </td>\n","          </tr>\n","          <!-- Footer -->\n","          <tr>\n","            <td align=\"center\" style=\"padding:10px; font-size:12px; color:#64748b;\">\n","              Source: EquiLend Data &amp; Analytics\n","            </td>\n","          </tr>\n","        </table>\n","      </td>\n","    </tr>\n","  </table>\n","</body>\n","</html>\n","\"\"\"\n","    return full_html\n","\n","# --- MAIN EXECUTION ---\n","if __name__ == \"__main__\":\n","    # Generate the full HTML content\n","    report_html = create_report_html_inline(\n","        REPORT_DATE,\n","        MARKET_NOTES,\n","        HEADLINES,\n","        HARD_TO_BORROW_DATA,\n","        SHORT_SQUEEZE_DATA,\n","        KEY_TAKEAWAYS\n","    )\n","\n","    # Write the HTML to a file\n","    file_name = f\"daily_digest_inline_{REPORT_DATE.replace(' ', '_').replace(',', '')}.html\"\n","    with open(file_name, \"w\", encoding=\"utf-8\") as f:\n","        f.write(report_html)\n","\n","    print(f\"Report successfully generated: {os.path.abspath(file_name)}\")"],"outputs":[{"output_type":"stream","name":"stdout","text":["Report successfully generated: /content/daily_digest_inline_July_18_2025.html\n"]}],"execution_count":1,"metadata":{"id":"NwCv6aKl5Jdo","executionInfo":{"status":"ok","timestamp":1752848204515,"user_tz":240,"elapsed":77,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"d862c0f3-4723-468f-c039-a9f030b3de1d","colab":{"base_uri":"https://localhost:8080/"}}}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}