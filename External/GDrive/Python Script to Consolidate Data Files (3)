{"cells":[{"cell_type":"code","source":"import pandas as pd\nimport os\nimport io\n\n# --- New Data for Equities ex-ETFs ---\n# This is the raw text data you provided.\nequities_ex_etf_data = \"\"\"\nBusiness Date,Active Lendable Quantity,On Loan Value\n7/10/2023,9.31E+11,9.57E+11\n7/11/2023,9.31E+11,9.57E+11\n7/12/2023,9.32E+11,9.71E+11\n7/13/2023,9.33E+11,9.83E+11\n7/14/2023,9.3E+11,9.82E+11\n7/17/2023,9.3E+11,9.7E+11\n7/18/2023,9.27E+11,9.73E+11\n7/19/2023,9.26E+11,9.82E+11\n7/20/2023,9.27E+11,9.86E+11\n7/21/2023,9.25E+11,9.91E+11\n7/24/2023,9.27E+11,9.93E+11\n7/25/2023,9.26E+11,1.02E+12\n7/26/2023,9.25E+11,1.02E+12\n7/27/2023,9.26E+11,1E+12\n7/28/2023,9.27E+11,1.01E+12\n7/31/2023,9.25E+11,9.97E+11\n8/1/2023,9.25E+11,9.88E+11\n8/2/2023,9.24E+11,9.69E+11\n8/3/2023,9.23E+11,9.55E+11\n8/4/2023,9.29E+11,9.59E+11\n8/7/2023,9.29E+11,9.73E+11\n8/8/2023,9.29E+11,9.62E+11\n8/9/2023,9.3E+11,9.61E+11\n8/10/2023,9.3E+11,9.74E+11\n8/11/2023,9.29E+11,9.76E+11\n8/14/2023,9.29E+11,9.77E+11\n8/15/2023,9.3E+11,9.82E+11\n8/16/2023,9.3E+11,9.75E+11\n8/17/2023,9.29E+11,9.88E+11\n8/18/2023,9.29E+11,9.84E+11\n8/21/2023,9.29E+11,1.01E+12\n8/22/2023,9.29E+11,1.02E+12\n8/23/2023,9.29E+11,1.01E+12\n8/24/2023,9.29E+11,9.87E+11\n8/25/2023,9.31E+11,9.7E+11\n8/28/2023,9.34E+11,9.84E+11\n8/29/2023,9.33E+11,9.87E+11\n8/30/2023,9.33E+11,1.01E+12\n8/31/2023,9.32E+11,1.02E+12\n9/1/2023,9.33E+11,1.03E+12\n9/4/2023,9.34E+11,1.03E+12\n9/5/2023,9.32E+11,1E+12\n9/6/2023,9.32E+11,9.89E+11\n9/7/2023,9.31E+11,9.98E+11\n9/8/2023,9.28E+11,1E+12\n9/11/2023,9.26E+11,1E+12\n9/12/2023,9.25E+11,1.02E+12\n9/13/2023,9.22E+11,1.03E+12\n9/14/2023,9.21E+11,1.03E+12\n9/15/2023,9.23E+11,1.05E+12\n9/18/2023,9.21E+11,1.06E+12\n9/19/2023,9.23E+11,1.05E+12\n9/20/2023,9.23E+11,1.04E+12\n9/21/2023,9.23E+11,1.03E+12\n9/22/2023,9.23E+11,1.02E+12\n9/25/2023,9.25E+11,1.01E+12\n9/26/2023,9.26E+11,1.02E+12\n9/27/2023,9.26E+11,1.01E+12\n9/28/2023,9.29E+11,1.02E+12\n9/29/2023,9.26E+11,1.03E+12\n10/2/2023,9.28E+11,1.03E+12\n10/3/2023,9.26E+11,1.01E+12\n10/4/2023,9.27E+11,9.8E+11\n10/5/2023,9.28E+11,9.83E+11\n10/6/2023,9.27E+11,9.73E+11\n10/9/2023,9.29E+11,9.71E+11\n11/1/2023,9.56E+11,9.15E+11\n11/2/2023,9.58E+11,9.23E+11\n11/3/2023,9.56E+11,9.4E+11\n11/6/2023,9.54E+11,9.59E+11\n11/7/2023,9.54E+11,9.45E+11\n11/8/2023,9.56E+11,9.47E+11\n11/9/2023,9.56E+11,9.38E+11\n12/1/2023,9.66E+11,9.93E+11\n12/4/2023,9.66E+11,1E+12\n12/5/2023,9.65E+11,9.88E+11\n12/6/2023,9.66E+11,9.84E+11\n12/7/2023,9.63E+11,9.86E+11\n12/8/2023,9.63E+11,9.91E+11\n1/1/2024,9.6E+11,1.01E+12\n1/2/2024,9.55E+11,9.87E+11\n1/3/2024,9.57E+11,9.77E+11\n1/4/2024,9.63E+11,9.52E+11\n1/5/2024,9.52E+11,9.48E+11\n1/8/2024,9.55E+11,9.44E+11\n1/9/2024,9.48E+11,9.48E+11\n1/10/2024,9.31E+11,9.37E+11\n1/11/2024,9.31E+11,9.27E+11\n1/12/2024,9.32E+11,9.36E+11\n1/15/2024,9.31E+11,9.45E+11\n1/16/2024,9.29E+11,9.09E+11\n1/17/2024,9.27E+11,9.08E+11\n1/18/2024,9.29E+11,9.01E+11\n1/19/2024,9.3E+11,9.1E+11\n1/23/2024,8.49E+11,8.41E+11\n1/24/2024,8.48E+11,8.64E+11\n1/25/2024,8.45E+11,8.68E+11\n1/26/2024,8.4E+11,8.8E+11\n1/29/2024,8.41E+11,8.91E+11\n1/30/2024,8.41E+11,8.48E+11\n1/31/2024,8.42E+11,8.37E+11\n2/1/2024,8.47E+11,8.69E+11\n2/2/2024,8.47E+11,9.05E+11\n2/5/2024,8.47E+11,8.84E+11\n2/6/2024,8.47E+11,8.71E+11\n2/7/2024,8.49E+11,8.8E+11\n2/8/2024,8.47E+11,8.82E+11\n2/9/2024,8.57E+11,8.92E+11\n2/12/2024,8.48E+11,9E+11\n2/13/2024,8.44E+11,9.06E+11\n2/14/2024,8.43E+11,8.96E+11\n2/15/2024,8.42E+11,9.19E+11\n2/16/2024,8.44E+11,9.36E+11\n2/19/2024,8.2E+11,9.36E+11\n2/20/2024,8.45E+11,9.33E+11\n2/21/2024,8.49E+11,9.31E+11\n2/22/2024,8.49E+11,9.45E+11\n2/23/2024,9.85E+11,9.62E+11\n2/26/2024,9.84E+11,9.73E+11\n2/27/2024,9.83E+11,9.66E+11\n2/28/2024,9.78E+11,9.73E+11\n2/29/2024,9.76E+11,9.86E+11\n3/1/2024,8.98E+11,1.02E+12\n3/4/2024,9.01E+11,1.05E+12\n3/5/2024,8.97E+11,1.03E+12\n3/6/2024,9.01E+11,1.02E+12\n3/7/2024,9.01E+11,1.04E+12\n3/8/2024,9E+11,1.06E+12\n3/11/2024,9E+11,1.06E+12\n3/12/2024,9E+11,1.06E+12\n3/13/2024,9E+11,1.07E+12\n3/14/2024,9.03E+11,1.1E+12\n3/15/2024,9.05E+11,1.09E+12\n3/18/2024,9.03E+11,1.09E+12\n3/19/2024,9.08E+11,1.11E+12\n3/20/2024,9.09E+11,1.09E+12\n3/21/2024,9.44E+11,1.1E+12\n3/22/2024,9.17E+11,1.1E+12\n3/25/2024,9.13E+11,1.09E+12\n3/26/2024,9.12E+11,1.1E+12\n3/27/2024,9.11E+11,1.11E+12\n3/28/2024,9.11E+11,1.15E+12\n3/29/2024,9.15E+11,1.16E+12\n4/1/2024,9.25E+11,1.15E+12\n4/2/2024,9.2E+11,1.13E+12\n4/3/2024,9.25E+11,1.09E+12\n4/4/2024,9.26E+11,1.07E+12\n4/5/2024,9.27E+11,1.05E+12\n4/8/2024,9.26E+11,1.04E+12\n4/9/2024,9.25E+11,1.04E+12\n4/10/2024,9.24E+11,1.03E+12\n4/11/2024,9.25E+11,1.01E+12\n4/12/2024,9.25E+11,1.01E+12\n4/15/2024,9.28E+11,9.96E+11\n4/16/2024,9.28E+11,9.82E+11\n4/17/2024,9.29E+11,9.8E+11\n4/18/2024,9.3E+11,9.82E+11\n4/19/2024,9.31E+11,9.78E+11\n4/22/2024,9.28E+11,9.89E+11\n4/23/2024,9.3E+11,1.01E+12\n4/24/2024,9.29E+11,1.02E+12\n4/25/2024,8.96E+11,1.02E+12\n4/26/2024,9.28E+11,1.02E+12\n4/29/2024,9.29E+11,1.03E+12\n4/30/2024,9.27E+11,1.03E+12\n5/1/2024,9.28E+11,1.02E+12\n5/2/2024,9.27E+11,1.01E+12\n5/3/2024,9.27E+11,1.02E+12\n5/6/2024,9.27E+11,1.02E+12\n5/7/2024,9.26E+11,1.03E+12\n5/8/2024,9.26E+11,1.03E+12\n5/9/2024,9.21E+11,1.03E+12\n5/10/2024,9.19E+11,1.04E+12\n5/13/2024,9.21E+11,1.04E+12\n5/14/2024,9.21E+11,1.04E+12\n5/15/2024,9.2E+11,1.06E+12\n5/16/2024,9.21E+11,1.06E+12\n5/17/2024,9.23E+11,1.05E+12\n5/20/2024,9.22E+11,1.05E+12\n5/21/2024,9.24E+11,1.04E+12\n5/22/2024,9.25E+11,1.03E+12\n5/23/2024,9.25E+11,1.02E+12\n5/24/2024,9.26E+11,1.03E+12\n5/27/2024,9.26E+11,1.03E+12\n5/28/2024,9.27E+11,1.03E+12\n5/29/2024,9.26E+11,1.03E+12\n5/30/2024,9.04E+11,1.02E+12\n5/31/2024,9E+11,1.03E+12\n6/3/2024,9.02E+11,1.04E+12\n6/4/2024,9.02E+11,1.04E+12\n6/5/2024,9.01E+11,1.02E+12\n6/6/2024,9.03E+11,1.05E+12\n6/7/2024,9E+11,1.04E+12\n6/10/2024,8.98E+11,1.03E+12\n6/11/2024,9E+11,1.01E+12\n6/12/2024,9.04E+11,1.01E+12\n6/13/2024,9.04E+11,1.02E+12\n6/14/2024,9.08E+11,1.02E+12\n6/17/2024,9.08E+11,1E+12\n6/18/2024,9.05E+11,1.01E+12\n6/19/2024,9.06E+11,9.97E+11\n6/20/2024,9.06E+11,9.96E+11\n6/21/2024,9.04E+11,9.92E+11\n6/24/2024,9.05E+11,1.02E+12\n6/25/2024,9.06E+11,1.01E+12\n6/26/2024,9.16E+11,1.01E+12\n6/27/2024,9.16E+11,1E+12\n6/28/2024,9.12E+11,1E+12\n7/1/2024,9.36E+11,1.02E+12\n7/2/2024,9.37E+11,9.86E+11\n7/3/2024,9.37E+11,9.93E+11\n7/4/2024,9.39E+11,9.87E+11\n7/5/2024,9.38E+11,9.74E+11\n7/8/2024,9.39E+11,9.71E+11\n7/9/2024,9.41E+11,9.67E+11\n7/10/2024,9.31E+11,9.61E+11\n7/11/2024,9.38E+11,9.59E+11\n7/12/2024,9.39E+11,9.7E+11\n7/15/2024,9.4E+11,9.71E+11\n7/16/2024,9.41E+11,9.69E+11\n7/17/2024,9.4E+11,9.65E+11\n7/18/2024,9.4E+11,9.58E+11\n7/19/2024,9.42E+11,9.52E+11\n7/22/2024,9.4E+11,9.51E+11\n7/23/2024,9.37E+11,9.56E+11\n7/24/2024,9.38E+11,9.62E+11\n7/25/2024,9.48E+11,1.02E+12\n7/26/2024,9.37E+11,9.49E+11\n7/29/2024,9.35E+11,9.52E+11\n7/30/2024,9.36E+11,9.48E+11\n7/31/2024,9.35E+11,9.53E+11\n8/1/2024,9.4E+11,9.56E+11\n8/2/2024,9.33E+11,9.47E+11\n8/5/2024,9.34E+11,9.34E+11\n8/6/2024,9.33E+11,9.33E+11\n8/7/2024,9.32E+11,9.35E+11\n8/8/2024,9.17E+11,9.55E+11\n8/9/2024,9.15E+11,9.53E+11\n8/12/2024,8.9E+11,9.62E+11\n8/13/2024,9.33E+11,9.58E+11\n8/14/2024,9.33E+11,9.79E+11\n8/15/2024,9.34E+11,1E+12\n8/16/2024,9.29E+11,9.97E+11\n8/19/2024,9.28E+11,1E+12\n8/20/2024,9.27E+11,1E+12\n8/21/2024,9.27E+11,9.85E+11\n8/22/2024,9.28E+11,9.9E+11\n8/23/2024,9.29E+11,9.92E+11\n8/26/2024,9.28E+11,9.98E+11\n8/27/2024,9.28E+11,1E+12\n8/28/2024,9.27E+11,9.98E+11\n8/29/2024,9.27E+11,9.95E+11\n8/30/2024,9.26E+11,1.03E+12\n9/2/2024,9.28E+11,1.04E+12\n9/3/2024,9.25E+11,1.02E+12\n9/4/2024,9.26E+11,1.03E+12\n9/5/2024,9.26E+11,1E+12\n9/6/2024,9.24E+11,1.01E+12\n9/9/2024,9.26E+11,1E+12\n9/10/2024,9.25E+11,1.01E+12\n9/11/2024,9.25E+11,1.01E+12\n9/12/2024,9.24E+11,1.04E+12\n9/13/2024,9.25E+11,1.07E+12\n9/16/2024,9.25E+11,1.06E+12\n9/17/2024,9.25E+11,1.05E+12\n9/18/2024,9.18E+11,1.05E+12\n9/19/2024,9.22E+11,1.07E+12\n9/20/2024,9.22E+11,1.1E+12\n9/23/2024,9.22E+11,1.13E+12\n9/24/2024,9.23E+11,1.11E+12\n9/25/2024,9.24E+11,1.11E+12\n9/26/2024,9.23E+11,1.11E+12\n9/27/2024,8.77E+11,1.11E+12\n9/30/2024,9.38E+11,1.13E+12\n10/1/2024,9.44E+11,1.11E+12\n10/2/2024,9.46E+11,1.09E+12\n10/3/2024,9.46E+11,1.07E+12\n10/4/2024,9.46E+11,1.05E+12\n10/7/2024,9.47E+11,1.05E+12\n10/8/2024,9.46E+11,1.03E+12\n10/9/2024,9.46E+11,1.02E+12\n11/1/2024,9.48E+11,9.47E+11\n11/4/2024,9.48E+11,9.53E+11\n11/5/2024,9.47E+11,9.53E+11\n11/6/2024,9.47E+11,9.58E+11\n11/7/2024,9.46E+11,9.86E+11\n11/8/2024,9.42E+11,9.94E+11\n12/2/2024,9.54E+11,1.03E+12\n12/3/2024,9.54E+11,1.03E+12\n12/4/2024,9.55E+11,1.01E+12\n12/5/2024,9.54E+11,1.02E+12\n12/6/2024,9.54E+11,1.02E+12\n12/9/2024,9.55E+11,1.03E+12\n1/1/2025,9.61E+11,1E+12\n1/2/2025,9.6E+11,9.98E+11\n1/3/2025,9.62E+11,1.01E+12\n1/6/2025,9.63E+11,9.98E+11\n1/7/2025,9.61E+11,1E+12\n1/8/2025,9.58E+11,9.95E+11\n1/9/2025,9.59E+11,9.89E+11\n1/10/2025,1.03E+12,9.81E+11\n1/13/2025,1.03E+12,9.73E+11\n1/14/2025,1.03E+12,9.73E+11\n1/15/2025,1.03E+12,9.74E+11\n1/16/2025,1.03E+12,9.86E+11\n1/17/2025,1.03E+12,1E+12\n1/20/2025,1.03E+12,1E+12\n1/21/2025,1.03E+12,1.01E+12\n1/22/2025,1.03E+12,1.01E+12\n1/23/2025,1.03E+12,1.02E+12\n1/24/2025,1.03E+12,1.02E+12\n1/27/2025,1.03E+12,1.03E+12\n1/28/2025,1.03E+12,1.02E+12\n1/29/2025,1.03E+12,1.03E+12\n1/30/2025,1.03E+12,1.03E+12\n1/31/2025,1.03E+12,1.04E+12\n2/3/2025,1.03E+12,1.03E+12\n2/4/2025,1.03E+12,1.02E+12\n2/5/2025,1.03E+12,1.03E+12\n2/6/2025,1.03E+12,1.04E+12\n2/7/2025,1.03E+12,1.04E+12\n2/10/2025,1.02E+12,1.04E+12\n2/11/2025,1.02E+12,1.05E+12\n2/12/2025,1.02E+12,1.06E+12\n2/13/2025,1.02E+12,1.06E+12\n2/14/2025,1.02E+12,1.1E+12\n2/17/2025,1.02E+12,1.1E+12\n2/18/2025,1.02E+12,1.09E+12\n2/19/2025,1.02E+12,1.08E+12\n2/20/2025,1.01E+12,1.1E+12\n2/21/2025,1.01E+12,1.0","outputs":[],"execution_count":null,"metadata":{}}],"metadata":{"colab":{"from_bard":true},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}