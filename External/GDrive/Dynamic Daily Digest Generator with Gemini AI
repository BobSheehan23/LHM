{"cells":[{"cell_type":"code","source":["pip install google-generativeai python-docx pandas openpyxl"],"metadata":{"collapsed":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"jJ7mAEfXrduu","executionInfo":{"status":"ok","timestamp":1754539101212,"user_tz":240,"elapsed":7313,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"6b784b24-9789-421e-a038-10be472b43d8"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: google-generativeai in /usr/local/lib/python3.11/dist-packages (0.8.5)\n","Collecting python-docx\n","  Downloading python_docx-1.2.0-py3-none-any.whl.metadata (2.0 kB)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (2.2.2)\n","Requirement already satisfied: openpyxl in /usr/local/lib/python3.11/dist-packages (3.1.5)\n","Requirement already satisfied: google-ai-generativelanguage==0.6.15 in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (0.6.15)\n","Requirement already satisfied: google-api-core in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (2.25.1)\n","Requirement already satisfied: google-api-python-client in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (2.177.0)\n","Requirement already satisfied: google-auth>=2.15.0 in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (2.38.0)\n","Requirement already satisfied: protobuf in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (5.29.5)\n","Requirement already satisfied: pydantic in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (2.11.7)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (4.67.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.11/dist-packages (from google-generativeai) (4.14.1)\n","Requirement already satisfied: proto-plus<2.0.0dev,>=1.22.3 in /usr/local/lib/python3.11/dist-packages (from google-ai-generativelanguage==0.6.15->google-generativeai) (1.26.1)\n","Requirement already satisfied: lxml>=3.1.0 in /usr/local/lib/python3.11/dist-packages (from python-docx) (5.4.0)\n","Requirement already satisfied: numpy>=1.23.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.0.2)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.9.0.post0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.2)\n","Requirement already satisfied: et-xmlfile in /usr/local/lib/python3.11/dist-packages (from openpyxl) (2.0.0)\n","Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /usr/local/lib/python3.11/dist-packages (from google-api-core->google-generativeai) (1.70.0)\n","Requirement already satisfied: requests<3.0.0,>=2.18.0 in /usr/local/lib/python3.11/dist-packages (from google-api-core->google-generativeai) (2.32.3)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.11/dist-packages (from google-auth>=2.15.0->google-generativeai) (5.5.2)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.11/dist-packages (from google-auth>=2.15.0->google-generativeai) (0.4.2)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.11/dist-packages (from google-auth>=2.15.0->google-generativeai) (4.9.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)\n","Requirement already satisfied: httplib2<1.0.0,>=0.19.0 in /usr/local/lib/python3.11/dist-packages (from google-api-python-client->google-generativeai) (0.22.0)\n","Requirement already satisfied: google-auth-httplib2<1.0.0,>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from google-api-python-client->google-generativeai) (0.2.0)\n","Requirement already satisfied: uritemplate<5,>=3.0.1 in /usr/local/lib/python3.11/dist-packages (from google-api-python-client->google-generativeai) (4.2.0)\n","Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic->google-generativeai) (0.7.0)\n","Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic->google-generativeai) (2.33.2)\n","Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic->google-generativeai) (0.4.1)\n","Requirement already satisfied: grpcio<2.0.0,>=1.33.2 in /usr/local/lib/python3.11/dist-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-ai-generativelanguage==0.6.15->google-generativeai) (1.74.0)\n","Requirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in /usr/local/lib/python3.11/dist-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-ai-generativelanguage==0.6.15->google-generativeai) (1.71.2)\n","Requirement already satisfied: pyparsing!=3.0.0,!=3.0.1,!=3.0.2,!=3.0.3,<4,>=2.4.2 in /usr/local/lib/python3.11/dist-packages (from httplib2<1.0.0,>=0.19.0->google-api-python-client->google-generativeai) (3.2.3)\n","Requirement already satisfied: pyasn1<0.7.0,>=0.6.1 in /usr/local/lib/python3.11/dist-packages (from pyasn1-modules>=0.2.1->google-auth>=2.15.0->google-generativeai) (0.6.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.18.0->google-api-core->google-generativeai) (3.4.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.18.0->google-api-core->google-generativeai) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.18.0->google-api-core->google-generativeai) (2.5.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.18.0->google-api-core->google-generativeai) (2025.7.14)\n","Downloading python_docx-1.2.0-py3-none-any.whl (252 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m253.0/253.0 kB\u001b[0m \u001b[31m3.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: python-docx\n","Successfully installed python-docx-1.2.0\n"]}]},{"cell_type":"code","source":["# -*- coding: utf-8 -*-\n","\"\"\"\n","daily_digest_generator.py\n","\n","This script dynamically generates an HTML daily digest by parsing content\n","from a Word document and uses the Gemini API to create an AI-powered\n","executive briefing.\n","\n","To run:\n","1. Make sure 'daily_content.docx' is in the same directory.\n","2. Install the required library: pip install python-docx pandas openpyxl\n","3. Run the script from your terminal: python daily_digest_generator.py\n","\"\"\"\n","\n","import pandas as pd\n","import docx\n","from datetime import datetime\n","import re\n","import os\n","\n","\n","# --- Configuration ---\n","CONTENT_DOC_PATH = 'daily_content.docx'\n","OUTPUT_HTML_PATH = f\"equilend_daily_digest_{datetime.now().strftime('%Y_%m_%d')}.html\"\n","\n","\n","# --- 1. DOCX Content Parsing ---\n","\n","def parse_daily_content(doc_path):\n","    \"\"\"\n","    Parses a .docx file for all text and table content.\n","    (This function is the same as the previous version)\n","    \"\"\"\n","    try:\n","        document = docx.Document(doc_path)\n","    except Exception as e:\n","        print(f\"Error opening or parsing DOCX file: {doc_path}. Error: {e}\")\n","        return None\n","\n","    content = {\n","        'market_notes': {}, 'headlines': [], 'key_takeaways': [],\n","        'hot_stocks_data': [], 'squeeze_stocks_data': []\n","    }\n","    paras = [p.text.strip() for p in document.paragraphs if p.text.strip()]\n","\n","    # Headline and Takeaway parsing logic remains the same\n","    try:\n","        headline_start_index = next((i for i, p in enumerate(paras) if 'major headlines' in p.lower()), -1)\n","        if headline_start_index != -1:\n","            i = headline_start_index + 1\n","            while i < len(paras):\n","                if 'what our data shows' in paras[i].lower() or 'key takeaways' in paras[i].lower() or 'hot & getting hotter' in paras[i].lower():\n","                    i += 1\n","                    continue\n","                end_of_block_idx = next((j for j in range(i + 1, len(paras)) if 'what our data shows' in paras[j].lower()), -1)\n","                if end_of_block_idx != -1:\n","                    title = paras[i].rstrip(':').rstrip('.')\n","                    description = \"\\n\".join(paras[i+1:end_of_block_idx])\n","                    data_insight_raw = paras[end_of_block_idx]\n","                    data_insight = re.sub(r'[\\starbullet\\s]*What our data shows:\\s?', '', data_insight_raw, flags=re.IGNORECASE).strip()\n","                    content['headlines'].append({'title': title, 'description': description, 'data_insight': data_insight})\n","                    i = end_of_block_idx + 1\n","                else: break\n","    except Exception as e:\n","        print(f\"Warning: Could not parse Headlines. Error: {e}\")\n","\n","    try:\n","        takeaways_start_index = next((i for i, p in enumerate(paras) if 'key takeaways' in p.lower()), -1)\n","        if takeaways_start_index != -1:\n","            for i in range(takeaways_start_index + 1, len(paras)):\n","                line = paras[i].lstrip('-•* ').strip()\n","                if not line or 'hot & getting hotter' in line.lower() or 'market technicals' in line.lower(): break\n","                content['key_takeaways'].append(line)\n","    except Exception as e:\n","        print(f\"Warning: Could not parse Key Takeaways. Error: {e}\")\n","\n","    # Table parsing logic remains the same\n","    for table in document.tables:\n","        if not table.rows: continue\n","        header_cells = [cell.text.strip().lower() for cell in table.rows[0].cells]\n","        if 'fee 1 wow (bps)' in header_cells:\n","            keys = [h.replace(' ', '_').replace('(', '').replace(')', '') for h in header_cells]\n","            for row in table.rows[1:]:\n","                content['hot_stocks_data'].append({keys[i]: cell.text.strip() for i, cell in enumerate(row.cells)})\n","        elif 'short squeeze score (sss)' in header_cells:\n","            keys = [h.replace(' ', '_').replace('(', '').replace(')', '') for h in header_cells]\n","            for row in table.rows[1:]:\n","                content['squeeze_stocks_data'].append({keys[i]: cell.text.strip() for i, cell in enumerate(row.cells)})\n","        elif len(table.rows) >= 2 and len(header_cells) >= 2:\n","            try:\n","                for row in table.rows:\n","                    cells = [cell.text.strip() for cell in row.cells]\n","                    if len(cells) < 2: continue\n","                    metric, value = cells[0].lower(), cells[1]\n","                    change = cells[2] if len(cells) > 2 else '0'\n","                    change_match = re.search(r'([+-]?\\d+\\.?\\d*)', change)\n","                    change_val = float(change_match.group(1)) if change_match else 0.0\n","\n","                    if 'average fee' in metric:\n","                        content['market_notes'].update({'avg_fee_bps': value.replace('bps', '').strip(), 'avg_fee_change': change_val})\n","                    elif 'average utilization' in metric:\n","                        content['market_notes'].update({'avg_util_percent': value.replace('%', '').strip(), 'avg_util_change': change_val})\n","                    elif 'on loan value' in metric:\n","                        content['market_notes'].update({'on_loan_value': value.replace('$', '').strip(), 'on_loan_value_change': change_val})\n","                    elif 'total lendable value' in metric:\n","                        content['market_notes'].update({'lendable_value': value.replace('$', '').strip(), 'lendable_value_change': change_val})\n","            except Exception as e:\n","                print(f\"Warning: Could not parse Market Notes from a table. Error: {e}\")\n","    return content\n","\n","\n","# --- 2. HTML Generation ---\n","\n","def create_digest_html(content):\n","    \"\"\"\n","    Generates the final HTML for the digest, now including the AI briefing.\n","    \"\"\"\n","    if not content:\n","        return \"<h1>Error: Could not generate content.</h1>\"\n","\n","    # Helper functions remain the same\n","    def format_change(value, unit=' BPS', dec=0):\n","        try:\n","            val = float(str(value).replace(',', '').strip())\n","            color = '#16a34a' if val > 0 else '#dc2626'\n","            sign = '+' if val > 0 else ''\n","            return f'<span style=\"color:{color};\">{sign}{val:,.{dec}f}{unit}</span>'\n","        except (ValueError, TypeError):\n","            return str(value).strip() if pd.notna(value) else ''\n","\n","    def format_market_note_change(value):\n","        color = '#16a34a' if value >= 0 else '#dc2626'\n","        sign = '+' if value >= 0 else ''\n","        return f'<span style=\"color:{color}; font-size:14px;\">{sign}{value:.2f}%</span>'\n","\n","    # Prepare Market Notes, Headlines, Tables, and Takeaways (same as before)\n","    market_notes = content.get('market_notes', {})\n","    avg_fee_change = format_market_note_change(market_notes.get('avg_fee_change', 0))\n","    avg_util_change = format_market_note_change(market_notes.get('avg_util_change', 0))\n","    on_loan_change = format_market_note_change(market_notes.get('on_loan_value_change', 0))\n","    lendable_change = format_market_note_change(market_notes.get('lendable_value_change', 0))\n","\n","    headlines_html = \"\".join([f\"\"\"\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px;\">{h['title']}</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap;\">{h['description']}</p>\n","        <div style=\"margin:10px 0 0; padding:10px; background-color:#f8fafc; border-left: 3px solid #0284c7;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> {h['data_insight']}\n","        </div>\n","    </div>\"\"\" for h in content.get('headlines', [])])\n","\n","    ht_borrow_html = \"\".join([f\"\"\"\n","    <tr style=\"font-size:12px; background-color:#ffffff; text-align:left; border-bottom: 1px solid #e2e8f0;\">\n","        <td style=\"padding:6px 8px;\">{r.get(\"ticker\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">{r.get(\"company_name\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">{r.get(\"industry\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">${r.get(\"price\", \"\").replace('$', '')}</td>\n","        <td style=\"padding:6px 8px;\">{format_change(r.get(\"fee_1_wow_bps\", \"\"))}</td>\n","    </tr>\"\"\" for r in content.get('hot_stocks_data', [])])\n","\n","    squeeze_html = \"\".join([f\"\"\"\n","    <tr style=\"font-size:12px; background-color:#ffffff; text-align:left; border-bottom: 1px solid #e2e8f0;\">\n","        <td style=\"padding:6px 8px;\">{r.get(\"ticker\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">{r.get(\"company_name\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">{r.get(\"industry\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">${r.get(\"price\", \"\").replace('$', '')}</td>\n","        <td style=\"padding:6px 8px;\">{r.get(\"short_squeeze_score_sss\", \"\")}</td>\n","        <td style=\"padding:6px 8px;\">{format_change(r.get(\"sss_wow\", \"\"), unit=\"\", dec=0)}</td>\n","    </tr>\"\"\" for r in content.get('squeeze_stocks_data', [])])\n","\n","    takeaways_html = \"\".join([f\"<li>{item}</li>\" for item in content.get('key_takeaways', [])])\n","\n","    # --- Assemble Final HTML with the new AI Briefing section ---\n","    html_template = f\"\"\"\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - {datetime.now().strftime('%B %d, %Y')}</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr><td align=\"center\">\n","    <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:8px; overflow:hidden; border: 1px solid #e2e8f0;\">\n","      <!-- Header -->\n","      <tr><td bgcolor=\"#0c4a6e\" style=\"padding:20px; text-align:center;\">\n","          <h1 style=\"margin:0; font-size:24px; color:#ffffff; font-weight:600;\">EquiLend D&A Daily Digest</h1>\n","          <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">{datetime.now().strftime('%B %d, %Y')}</p>\n","      </td></tr>\n","      <!-- Main Content -->\n","      <tr><td style=\"padding:24px; color:#334155; font-size:14px; line-height:1.6;\">\n","\n","          <!-- Market Notes -->\n","          <h2 style=\"font-size:18px; margin-bottom:10px; color:#0c4a6e;\">&#x1F4BC; Market Notes</h2>\n","          <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px; border-radius:6px;\">\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">{market_notes.get('avg_fee_bps', 'N/A')} bps {avg_fee_change}</p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">{market_notes.get('avg_util_percent', 'N/A')}% {avg_util_change}</p></td>\n","            </tr>\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">${market_notes.get('on_loan_value', 'N/A')} {on_loan_change}</p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">${market_notes.get('lendable_value', 'N/A')} {lendable_change}</p></td>\n","            </tr>\n","          </table>\n","\n","          <!-- Headlines -->\n","          <h2 style=\"font-size:18px; margin-bottom:10px; color:#0c4a6e;\">&#x1F4F0; Major Headlines</h2>\n","          {headlines_html}\n","\n","          <!-- Tables Section -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F525; Hot & Getting Hotter</h2>\n","          <div style=\"font-size:12px; font-style:italic; color:#64748b; margin-bottom:10px;\">Top stocks with high and rising fees, indicating increased short interest.</div>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px;\">Ticker</th><th style=\"padding:8px;\">Company</th><th style=\"padding:8px;\">Industry</th><th style=\"padding:8px;\">Price</th><th style=\"padding:8px;\">Fee 1W Change</th></tr></thead>\n","            <tbody>{ht_borrow_html}</tbody>\n","          </table>\n","\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px;\">Ticker</th><th style=\"padding:8px;\">Company</th><th style=\"padding:8px;\">Industry</th><th style=\"padding:8px;\">Price</th><th style=\"padding:8px;\">SSS</th><th style=\"padding:8px;\">SSS WoW</th></tr></thead>\n","            <tbody>{squeeze_html}</tbody>\n","          </table>\n","\n","          <!-- Key Takeaways -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F4A1; Key Takeaways</h2>\n","          <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\">{takeaways_html}</ul>\n","\n","      </td></tr>\n","      <!-- Footer -->\n","      <tr><td align=\"center\" style=\"padding:15px; font-size:12px; color:#64748b; background-color:#f8fafc;\">\n","          Source: EquiLend Data &amp; Analytics\n","      </td></tr>\n","    </table>\n","    </td></tr>\n","  </table>\n","</body>\n","</html>\n","    \"\"\"\n","    return html_template\n","\n","# --- Main Execution ---\n","if __name__ == \"__main__\":\n","    print(\"Starting daily digest generation...\")\n","\n","\n","    # 1. Parse all content from the single Word document\n","    print(f\"Reading all content from '{CONTENT_DOC_PATH}'...\")\n","    parsed_content = parse_daily_content(CONTENT_DOC_PATH)\n","\n","    if parsed_content:\n","        # 2. Generate the final HTML file\n","        print(\"Generating final HTML digest...\")\n","        final_html = create_digest_html(parsed_content)\n","\n","        # 3. Save the HTML to a file\n","        with open(OUTPUT_HTML_PATH, 'w', encoding='utf-8') as f:\n","            f.write(final_html)\n","\n","        print(f\"\\nSuccessfully generated digest: {OUTPUT_HTML_PATH}\")\n","        print(\"You can open this HTML file in any web browser.\")\n","    else:\n","        print(\"\\nCould not generate digest due to parsing errors.\")"],"outputs":[{"output_type":"stream","name":"stdout","text":["Starting daily digest generation...\n","Reading all content from 'daily_content.docx'...\n","Generating final HTML digest...\n","\n","Successfully generated digest: equilend_daily_digest_2025_08_07.html\n","You can open this HTML file in any web browser.\n"]}],"execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FciyAdCMrXbM","executionInfo":{"status":"ok","timestamp":1754539363239,"user_tz":240,"elapsed":59,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"ad6767d2-8bcf-45e6-a09c-1971ea5efdd4"}},{"cell_type":"code","source":["from IPython.display import display, HTML\n","import os\n","\n","# Define the HTML file path\n","OUTPUT_HTML_PATH = f\"equilend_daily_digest_{datetime.now().strftime('%Y_%m_%d')}.html\"\n","\n","# Check if the file exists before attempting to display\n","if os.path.exists(OUTPUT_HTML_PATH):\n","    with open(OUTPUT_HTML_PATH, 'r', encoding='utf-8') as f:\n","        html_content = f.read()\n","    display(HTML(html_content))\n","else:\n","    print(f\"Error: The file '{OUTPUT_HTML_PATH}' was not found.\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"dkMvEEHqrlgp","executionInfo":{"status":"ok","timestamp":1754539420165,"user_tz":240,"elapsed":35,"user":{"displayName":"Bob Sheehan","userId":"08159093702253523584"}},"outputId":"f3fd399d-9e86-4b58-ac57-4eacd1ff71bb"},"execution_count":7,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<!DOCTYPE html>\n","<html lang=\"en\">\n","<head>\n","  <meta charset=\"UTF-8\">\n","  <title>EquiLend D&A Daily Digest - August 07, 2025</title>\n","</head>\n","<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color:#f1f5f9;\">\n","  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f1f5f9\">\n","    <tr><td align=\"center\">\n","    <table width=\"800\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"margin:20px 0; border-radius:8px; overflow:hidden; border: 1px solid #e2e8f0;\">\n","      <!-- Header -->\n","      <tr><td bgcolor=\"#0c4a6e\" style=\"padding:20px; text-align:center;\">\n","          <h1 style=\"margin:0; font-size:24px; color:#ffffff; font-weight:600;\">EquiLend D&A Daily Digest</h1>\n","          <p style=\"margin:5px 0 0; font-size:16px; color:#bae6fd;\">August 07, 2025</p>\n","      </td></tr>\n","      <!-- Main Content -->\n","      <tr><td style=\"padding:24px; color:#334155; font-size:14px; line-height:1.6;\">\n","\n","          <!-- Market Notes -->\n","          <h2 style=\"font-size:18px; margin-bottom:10px; color:#0c4a6e;\">&#x1F4BC; Market Notes</h2>\n","          <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f8fafc\" style=\"margin-bottom:20px; border-radius:6px;\">\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Fee</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">N/A bps <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span></p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Average Utilization</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">N/A% <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span></p></td>\n","            </tr>\n","            <tr>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">On Loan Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">$N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span></p></td>\n","              <td align=\"center\" width=\"50%\"><p style=\"margin:0; font-size:12px; color:#64748b;\">Total Lendable Value</p><p style=\"margin:5px 0 0; font-size:18px; font-weight:bold;\">$N/A <span style=\"color:#16a34a; font-size:14px;\">+0.00%</span></p></td>\n","            </tr>\n","          </table>\n","\n","          <!-- Headlines -->\n","          <h2 style=\"font-size:18px; margin-bottom:10px; color:#0c4a6e;\">&#x1F4F0; Major Headlines</h2>\n","          \n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px;\">Oil Prices Decline Amid OPEC+ Production and Demand Concerns</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap;\">Crude oil prices have fallen, with reports indicating that profits for major energy companies like Exxon Mobil and Chevron have dropped to their lowest levels in four years. This is occurring as OPEC+ ramps up production, and concerns about a slowing global economy may be signaling a demand reduction. This dynamic highlights the potential for a softening global economic environment impacting commodity markets.</p>\n","        <div style=\"margin:10px 0 0; padding:10px; background-color:#f8fafc; border-left: 3px solid #0284c7;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> With the Middle Eastern conflict generating oil supply concerns and the added effect of tariffs, the energy sector as a whole has been notably volatile throughout the past few months. Our data highlights this, with a 2-year high in on-loan quantity being reached at the start of July at 8.57 billion shares globally. In turn, as these geopolitical and tariff issues have reduced, we have since seen this loan volume begin to fall, with a reduction of 15% compared to the early July heights of 7.27 billion shares.\n","        </div>\n","    </div>\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px;\">Chips and Semiconductors Underdogs Struggle to Keep Pace</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap;\">With uncertainty surrounding access for semiconductor producers to key markets such as China, smaller players in the field are increasingly struggling to compete with market leaders like Nvidia. Tariffs on semiconductors will be announced within the next week or so, but in the meantime, companies including Super Micro and Advanced Micro Devices have lowered fiscal year sales forecasts and are falling in extended trading.</p>\n","        <div style=\"margin:10px 0 0; padding:10px; background-color:#f8fafc; border-left: 3px solid #0284c7;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> On the contrary, some firms are benefitting from opening gaps in the semiconductor market, with others struggling and tariffs to be imposed on overseas opposition. Wall Street analysts appear bullish regarding Rigetti Computing (RGTI) in particular, with strong buy recommendations. Consequently, we have seen a downfall in short interest in RGTI in our data, with borrowing costs hitting a two-year low at 44 bps, a significant fall from over 640 bps at the start of April.\n","        </div>\n","    </div>\n","    <div style=\"margin-top:20px;\">\n","        <strong style=\"font-size:16px;\">European Equities Rise despite fresh tariff threats</strong>\n","        <p style=\"margin:5px 0 0; white-space: pre-wrap;\">The STOXX 600 index continues to rise as investors ‘bought the dip’ created by recent market weakness, despite the announcement from Trump that markets such as semiconductors and pharmaceuticals will have fresh tariffs announced in ‘the next week or so’.</p>\n","        <div style=\"margin:10px 0 0; padding:10px; background-color:#f8fafc; border-left: 3px solid #0284c7;\">\n","          <strong style=\"color:#0284c7;\">What Our Data Shows:</strong> In response to the worst of the tariff fallout between the E.U. and the U.S. in the past, our data shows an expected cooling in the European equity market. Short interest in this field has declined significantly as the volume of shares on loan has reduced to 190 billion, from the peak tariff values of around 250 billion. In parallel, following fluctuation throughout the tariff discussions, borrowing costs have returned to ~40 bps, the same fee seen as this time last year.\n","        </div>\n","    </div>\n","\n","          <!-- Tables Section -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F525; Hot & Getting Hotter</h2>\n","          <div style=\"font-size:12px; font-style:italic; color:#64748b; margin-bottom:10px;\">Top stocks with high and rising fees, indicating increased short interest.</div>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px;\">Ticker</th><th style=\"padding:8px;\">Company</th><th style=\"padding:8px;\">Industry</th><th style=\"padding:8px;\">Price</th><th style=\"padding:8px;\">Fee 1W Change</th></tr></thead>\n","            <tbody></tbody>\n","          </table>\n","\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F52C; Market Technicals & Squeeze Metrics</h2>\n","          <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; font-size:12px;\" width=\"100%\">\n","            <thead><tr bgcolor=\"#f1f5f9\" style=\"color:#334155; font-weight:bold; text-align:left;\"><th style=\"padding:8px;\">Ticker</th><th style=\"padding:8px;\">Company</th><th style=\"padding:8px;\">Industry</th><th style=\"padding:8px;\">Price</th><th style=\"padding:8px;\">SSS</th><th style=\"padding:8px;\">SSS WoW</th></tr></thead>\n","            <tbody></tbody>\n","          </table>\n","\n","          <!-- Key Takeaways -->\n","          <h2 style=\"font-size:18px; margin:25px 0 10px; color:#0c4a6e;\">&#x1F4A1; Key Takeaways</h2>\n","          <ul style=\"padding-left:20px; color:#334155; font-size:14px; margin:0;\"><li>Key takeaways 1</li><li>Key takeaways 2</li><li>Key takeaways 3</li></ul>\n","\n","      </td></tr>\n","      <!-- Footer -->\n","      <tr><td align=\"center\" style=\"padding:15px; font-size:12px; color:#64748b; background-color:#f8fafc;\">\n","          Source: EquiLend Data &amp; Analytics\n","      </td></tr>\n","    </table>\n","    </td></tr>\n","  </table>\n","</body>\n","</html>\n","    "]},"metadata":{}}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}